<html>
    <head>
        <title>Canigó - Espai Privat : Tags de Presentació</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Canigó - Espai Privat : Tags de Presentació
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on May 28, 2009 by <font color="#0050B2">otc</font>.
				    </div>

				    <h1><a name="TagsdePresentaci%C3%B3-Introducci%C3%B3"></a>Introducció</h1>


<h2><a name="TagsdePresentaci%C3%B3-Prop%C3%B2sit"></a>Propòsit</h2>

<p>El Servei de Tags té com a propòsit principal oferir components a utilitzar dins de les nostres pàgines. En l'actualitat es basen en l'ús de pàgines JSP (Java Server Pages).</p>

<h2><a name="TagsdePresentaci%C3%B3-ContextiEscenarisd%27%C3%9As"></a>Context i Escenaris d'Ús</h2>

<p>El Servei de Tags es troba dins dels serveis de Presentació de Canigó.</p>

<h3><a name="TagsdePresentaci%C3%B3-Depend%C3%A8nciesb%C3%A0siques"></a>Dependències bàsiques</h3>

<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Nom</b> </td>
<td class='confluenceTd'> <b>Tipus</b> </td>
<td class='confluenceTd'> <b>Versió</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> ajaxtags </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.1 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> dwr </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.1.3 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> jsp-api </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 2.0 </td>
<td class='confluenceTd'> <a href="http://java.sun.com/products/jsp" title="Visit page outside Confluence">http://java.sun.com/products/jsp</a> </td>
</tr>
<tr>
<td class='confluenceTd'> jstl </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.1.1 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> nekohtml </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 0.8.1 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-core </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-services-configuration </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-services-exceptions </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-services-i18n </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-services-logging </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-services-validation </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> openFrame-services-web </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.0 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> oro </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 2.0.8 </td>
<td class='confluenceTd'> <a href="http://jakarta.apache.org/oro/" title="Visit page outside Confluence">http://jakarta.apache.org/oro/</a> </td>
</tr>
<tr>
<td class='confluenceTd'> js </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.5R4.1 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> servlet-api </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 2.4 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> spring </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.2.5 </td>
<td class='confluenceTd'> <a href="http://www.springframework.org/" title="Visit page outside Confluence">http://www.springframework.org</a> </td>
</tr>
<tr>
<td class='confluenceTd'> struts-layout </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.2_20051027 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> struts-menu </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 2.3 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> struts </td>
<td class='confluenceTd'> jar </td>
<td class='confluenceTd'> 1.2.7 </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
</tbody></table>
<p>Per cada servei openFrame fer ús també de les dependències requerides per ell.</p>

<p>Es recomana consultar la referència del servidor d'aplicacions en el que es farà el deployment de l'aplicació per conèixer si les versions aquí indicades estan permeses.</p>

<h2><a name="TagsdePresentaci%C3%B3-Aquivadirigit"></a>A qui va dirigit</h2>

<p>Aquest document va dirigit als següents perfils:</p>
<ol>
	<li>Programador. Per configurar els tags i editar les pàgines</li>
	<li>Dissenyador. Per definir els estils i la composició de les pàgines</li>
</ol>


<h2><a name="TagsdePresentaci%C3%B3-DocumentsiFontsderefer%C3%A8ncia"></a>Documents i Fonts de referència</h2>

<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Advanced CSS </td>
<td class='confluenceTd'> <a href="http://www.yourhtmlsource.com/stylesheets/advancedcss.html" title="Visit page outside Confluence">http://www.yourhtmlsource.com/stylesheets/advancedcss.html</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Overlib </td>
<td class='confluenceTd'> <a href="http://www.bosrup.com/web/overlib/" title="Visit page outside Confluence">http://www.bosrup.com/web/overlib/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Dom tooltip </td>
<td class='confluenceTd'> <a href="http://www.mojavelinux.com/projects/domtooltip/HOWTO.html" title="Visit page outside Confluence">http://www.mojavelinux.com/projects/domtooltip/HOWTO.html</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Dynarch Calendar </td>
<td class='confluenceTd'> <a href="http://www.dynarch.com/projects/calendar/" title="Visit page outside Confluence">http://www.dynarch.com/projects/calendar/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> DHTML Internet Explorer </td>
<td class='confluenceTd'> <a href="http://msdn.microsoft.com/workshop/author/dhtml/reference/objects.asp" title="Visit page outside Confluence">http://msdn.microsoft.com/workshop/author/dhtml/reference/objects.asp</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Prototype library </td>
<td class='confluenceTd'> <a href="http://prototype.conio.net/" title="Visit page outside Confluence">http://prototype.conio.net/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Value List </td>
<td class='confluenceTd'> <a href="http://valuelist.sourceforge.net/" title="Visit page outside Confluence">http://valuelist.sourceforge.net/</a> </td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> Struts Layout </td>
<td class='confluenceTd'> <a href="http://struts.application-servers.com/doc/tags/layout.html" title="Visit page outside Confluence">http://struts.application-servers.com/doc/tags/layout.html</a> </td>
</tr>
</tbody></table>

<h2><a name="TagsdePresentaci%C3%B3-Glossari"></a>Glossari</h2>

<p><b>TLD (Tag Library Descriptor)</b></p>

<p>Un TLD és un fitxer en format XML que permet a un desenvolupador definir un conjunt de tags. Per cada tag es poden descriure els seus atributs i la classe associada que generarà el contingut de sortida a la pàgina en la que es faci servir.</p>

<p>Tot i que l'ús de tags específics permet eliminar l'ús de codi Java des de les nostres pàgines JSP, no eliminen la necessitat de crear codi Java. S'han de crear igualment classes Java que facin el treball del tag. Aquestes classes han de estendre les classes definides al package 'tagext' de J2EE.</p>

<h1><a name="TagsdePresentaci%C3%B3-Descripci%C3%B3Detallada"></a>Descripció Detallada</h1>


<h2><a name="TagsdePresentaci%C3%B3-ArquitecturaiComponents"></a>Arquitectura i Components</h2>

<p>L'arquitectura del Servei de Tags és basa en l'ús de llibreries de tags JSP.</p>

<p>Es recomana una lectura prèvia de la url '<a href="http://java.sun.com/products/jsp/tutorial/TagLibrariesTOC.html'" title="Visit page outside Confluence">http://java.sun.com/products/jsp/tutorial/TagLibrariesTOC.html'</a> per conèixer què és una llibreria de tags, com es creen i com s'utilitzen.&#124;http://java.sun.com/products/jsp/tutorial/TagLibrariesTOC.html]</p>

<h3><a name="TagsdePresentaci%C3%B3-ArquitecturadeProcedimentd%27Inicialitzaci%C3%B3Intern"></a>Arquitectura de Procediment d'Inicialització Intern</h3>

<p>Existeix un mètode avançat de configuració dels tags de forma externa en un fitxer de configuració, de forma que podem heretar propietats d'altres tags. Es tracta d'un mecanisme en rares ocasions necessari però podeu consultar-ho en el següent enllaç <a href="Configuració dels Tags amb Fitxers de Configuració.html" title="Configuració dels Tags amb Fitxers de Configuració">Configuració dels Tags amb Fitxers de Configuració</a></p>

<h3><a name="TagsdePresentaci%C3%B3-PropietatsdetotselstagsdeFormulari"></a>Propietats de tots els tags de Formulari</h3>


<h4><a name="TagsdePresentaci%C3%B3-%5C%5C"></a><br clear="all" /></h4>
<p><br clear="all" />
Configuració del Tag 'TextArea'
<br clear="all" />
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> rows </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Número de files </td>
</tr>
<tr>
<td class='confluenceTd'> cols </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Número de columnes </td>
</tr>
<tr>
<td class='confluenceTd'> decoratorProperties </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet especificar la generació d'una àrea amb justificats, formats, ... </td>
</tr>
</tbody></table>
<ol>
	<li><b>decoratorProperties</b></li>
</ol>


<p>Permet especificar la generació d'un textarea en el que es permetin justificats, 	formats, colors, etc. El contingut aquí introduït serà enviat com HTML.</p>

<p>Per especificar els decoratorProperties usarem els següents valors:</p>
<ol>
	<li>theme: 'advanced' o 'simple' (si volem més o menys opcions)</li>
	<li>mode: 'exact'</li>
</ol>


<p>Exemple:
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"textAreaFieldTag"</span>&gt;
&lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"comments"</span>/&gt;
&lt;property name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.comments"</span>/&gt;
&lt;property name=<span class="code-quote">"rows"</span> value=<span class="code-quote">"10"</span>/&gt;
&lt;property name=<span class="code-quote">"cols"</span> value=<span class="code-quote">"40"</span>/&gt;
&lt;property name=<span class="code-quote">"decoratorProperties"</span>&gt;
&lt;map&gt;
&lt;entry&gt;
&lt;key&gt;&lt;value&gt;theme&lt;/value&gt;&lt;/key&gt;
&lt;value&gt;advanced&lt;/value&gt;
&lt;/entry&gt;
&lt;entry&gt;
&lt;key&gt;&lt;value&gt;mode&lt;/value&gt;&lt;/key&gt;
&lt;value&gt;exact&lt;/value&gt;
&lt;/entry&gt;
&lt;/map&gt;
&lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div><br clear="all" />
<br clear="all" />
Mitjançant l'exemple a dalt mostrat tindríem un component com el mostrat a continuació:<br/>
Configuració del Tag 'Select'
<br clear="all" /></p>

<p>Permet definir les mateixes propietats que les definides per Struts i les propietats generals a tots els tags d'entrada de formulari definides anteriorment.</p>

<p>Addicionalment es proporcionen 2 funcionalitats prou importants:</p>
<ol>
	<li>Generació d'opcions segons una query de base de dades</li>
	<li>Generació de les opcions segons el valor escollit en un altre select de forma dinàmica sense refresc de la pàgina</li>
	<li><b>Generació de les opcions segons query de la base de dades</b></li>
</ol>


<p>Si volem mostrar una llista d'opcions que prové d'una base de dades openFrame openFrame ofereix la possibilitat de definir la font de les dades.</p>

<p>Per això cal que seguim els següents passos:</p>
<ol>
	<li>Definir l'adaptador que s'usarà basat en Hibernate
<br clear="all" />
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>

class=<span class="code-quote">"net.mlw.vlh.adapter.hibernate3.Hibernate30Adapter"</span>&gt;

&lt;property name=<span class="code-quote">"sessionFactory"</span> ref=<span class="code-quote">"sessionFactory"</span>/&gt;

&lt;property name=<span class="code-quote">"defaultNumberPerPage"</span> value=<span class="code-quote">"5"</span>/&gt;

&lt;property name=<span class="code-quote">"defaultSortColumn"</span> value=<span class="code-quote">"id"</span>/&gt;

&lt;property name=<span class="code-quote">"defaultSortDirection"</span> value=<span class="code-quote">"asc"</span>/&gt;

&lt;property name=<span class="code-quote">"removeEmptyStrings"</span> value=<span class="code-quote">"<span class="code-keyword">true</span>"</span>/&gt;

&lt;/bean&gt;</pre>
</div></div><br clear="all" />
<br clear="all" /></li>
</ol>


<p>El seu ús és equivalent al definit pel Servei de Llistats.</p>
<ol>
	<li>Gestors de les llistes
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean name=<span class="code-quote">"defaultOptionValueListHandler"</span> class=<span class="code-quote">"net.mlw.vlh.DefaultValueListHandlerImpl"</span>&gt;
   &lt;property name=<span class="code-quote">"config.adapters"</span>&gt;
      &lt;map&gt;
         &lt;entry key=<span class="code-quote">"categoriesList"</span>&gt;
            &lt;bean parent=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>&gt;
               &lt;property name=<span class="code-quote">"hql"</span>&gt;
                  &lt;value&gt;
                     FROM net.gencat.ctti.canigo.samples.prototip.model.Category
                      AS vo WHERE 1=1
                     /~descn: AND vo.descn LIKE \{descn\} \~/
                     /~sortColumn: ORDER BY vo.\[sortColumn\] \[sortDirection\]~/
                  &lt;/value&gt;
               &lt;/property&gt;
            &lt;/bean&gt;
         &lt;/entry&gt;
      &lt;/map&gt;
   &lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div></li>
</ol>


<p>En la propietat 'config.adapters' definirem les diferents queries a executar per a recuperar les llistes. Aquestes queries es troben definides en HQL, pel que obtenim objectes.</p>
<ol>
	<li>key. Nom de la llista (aquest nom serà utilitzat des de la definició del tag)</li>
	<li>hql. Definició de la consulta Hibernate per a obtenir la llista de valors</li>
</ol>


<p>&lt;entry key="nomLlista"&gt;<br/>
&lt;bean parent="defaultOptionBaseHibernateAdapter"&gt;<br/>
&lt;property name="hql"&gt;<br/>
...</p>
<ol>
	<li>Definir les següents entrades:
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"defaultOptionValueListHandlerHelper"</span> class=<span class="code-quote">"net.mlw.vlh.web.mvc.ValueListHandlerHelper"</span>&gt;
   &lt;property name=<span class="code-quote">"valueListHandler"</span>&gt;
      &lt;ref bean=<span class="code-quote">"defaultOptionValueListHandler"</span> /&gt;
   &lt;/property&gt;
&lt;/bean&gt;

&lt;bean name=<span class="code-quote">"defaultOptionListSource"</span>
  class=<span class="code-quote">"net.gencat.ctti.canigo.services.web.taglib.util.options.vlh.hibernate3.VlhOptionListSourceImpl"</span>&gt;
   &lt;property name=<span class="code-quote">"valueListHandlerHelper"</span>&gt;
      &lt;ref bean=<span class="code-quote">"defaultOptionValueListHandlerHelper"</span> /&gt;
   &lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div></li>
</ol>


<ol>
	<li>Definir la informació de la font de la nostra llista</li>
</ol>


<ol>
	<li>optionListName: Referència a la definició de la llista definida al pas 2</li>
	<li>optionLabelName: Atribut de l'objecte recuperat que servirà d'etiqueta de l'opció</li>
	<li>optionLabelProperty: Atribut de l'objecte recuperat que servirà de valor de l'opció</li>
</ol>


<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"categoriesOptionListSource"</span> parent=<span class="code-quote">"defaultOptionListSource"</span>&gt;
   &lt;property name=<span class="code-quote">"optionListName"</span> value=<span class="code-quote">"categoriesList"</span>/&gt;
   &lt;property name=<span class="code-quote">"optionLabelName"</span> value=<span class="code-quote">"name"</span>/&gt;
   &lt;property name=<span class="code-quote">"optionLabelProperty"</span> value=<span class="code-quote">"id"</span>/&gt;
&lt;/bean&gt;</pre>
</div></div>

<ol>
	<li>Incorporar la llista al servei d'opcions</li>
</ol>


<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"optionsListService"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.web.taglib.util.options.OptionsListServiceBase"</span>&gt;
   &lt;property name=<span class="code-quote">"optionsListSources"</span>&gt;
      &lt;map&gt;
         &lt;entry key=<span class="code-quote">"categoriesList"</span>&gt;
            &lt;ref bean=<span class="code-quote">"categoriesOptionListSource"</span>/&gt;
         &lt;/entry&gt;
         &lt;entry key=<span class="code-quote">"animalsList"</span>&gt;
            &lt;ref bean=<span class="code-quote">"animalsOptionListSource"</span>/&gt;
         &lt;/entry&gt;
      &lt;/map&gt;
   &lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div>

<ol>
	<li>Per últim definir a la propietat 'optionsListService' del tag una referència al servei d'opcions (propietat 'optionsListService') i afegir el nom de la llista a la propietat 'optionsListName':</li>
</ol>


<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean id=<span class="code-quote">"selectFieldTag"</span> class=<span class="code-quote">"net.gencat.ctti.canigo.services.web.struts.taglib.forms.fields.SelectFieldTag"</span>&gt;
   ...
   &lt;property name=<span class="code-quote">"optionsListService"</span> ref=<span class="code-quote">"optionsListService"</span>/&gt;
   ...

&lt;bean parent=<span class="code-quote">"selectFieldTag"</span>&gt;
   &lt;property name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.preferredCategory"</span>/&gt;
   &lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"preferredCategoryId"</span>/&gt;
   &lt;property name=<span class="code-quote">"optionsListName"</span> value=<span class="code-quote">"categoriesList"</span>/&gt;
&lt;/bean&gt;</pre>
</div></div>

<ol>
	<li><b>Generació de les opcions segons el valor escollit en un altre select</b></li>
</ol>


<p>En cas de voler presentar la llista d'opcions d'un select segons la selecció realitzada	a un altra selecció, definirem a més del definit en la secció anterior un nou atribut 'selectFieldSource' en el que definirem:</p>
<ol>
	<li>source. Nom de la propietat 'styleId' utilitzada en el select font</li>
	<li>paramName. Nom del paràmetre de la query definit entre {}.</li>
</ol>


<p>Per exemple, imaginem que volem mostrar la llista d'animals segons la categoria escollida.</p>

<p>Podem definir la hql de la llista 'animalsList' tal i com es mostra a continuació:</p>
<div class="code"><div class="codeContent">
<pre class="code-java">&lt;entry key=<span class="code-quote">"animalsList"</span>&gt;
   &lt;bean parent=<span class="code-quote">"defaultOptionBaseHibernateAdapter"</span>&gt;
      &lt;property name=<span class="code-quote">"hql"</span>&gt;
         &lt;value&gt;
           FROM net.gencat.ctti.canigo.samples.prototip.model.Product
           AS vo WHERE 1=1
           /~category: AND vo.category.id LIKE \{category\} \~/
           /~sortColumn: ORDER BY vo.\[sortColumn\] \[sortDirection\]~/
         &lt;/value&gt;
      &lt;/property&gt;
   &lt;/bean&gt;
&lt;/entry&gt;</pre>
</div></div>

<p>En aquesta hql apareix el paràmetre {category} dins el LIKE que és el que ens permetrà lligar que se'ns retornin els productes amb la categoria indicada.</p>

<p>Per a que s'envii com a criteri valor dins {category} el valor escollit a la select source definirem com a 'paramName' el valor 'category'.</p>

<div class="code"><div class="codeContent">
<pre class="code-java">&lt;bean parent=<span class="code-quote">"selectFieldTag"</span>&gt;
   &lt;property name=<span class="code-quote">"key"</span> value=<span class="code-quote">"forms.accountForm.field.preferredAnimal"</span>/&gt;
   &lt;property name=<span class="code-quote">"styleId"</span> value=<span class="code-quote">"preferredAnimalId"</span>/&gt;
   &lt;property name=<span class="code-quote">"optionsListName"</span> value=<span class="code-quote">"animalsList"</span>/&gt;
   &lt;property name=<span class="code-quote">"selectFieldSource"</span>&gt;
      &lt;map&gt;
         &lt;entry&gt;
            &lt;key&gt;&lt;value&gt;source&lt;/value&gt;&lt;/key&gt;
            &lt;value&gt;preferredCategoryId&lt;/value&gt;
         &lt;/entry&gt;
         &lt;entry&gt;
            &lt;key&gt;&lt;value&gt;paramName&lt;/value&gt;&lt;/key&gt;
            &lt;value&gt;category&lt;/value&gt;
         &lt;/entry&gt;
      &lt;/map&gt;
   &lt;/property&gt;
&lt;/bean&gt;</pre>
</div></div>

<p>Configuració del Tag 'Checkbox'</p>

<p>Permet definir les mateixes propietats que les definides per Struts i les propietats generals a tots els tags d'entrada de formulari definides anteriorment.</p>

<p>Exemple:</p>

<p>&lt;bean id="checkboxFieldTag" class="net.opentrends.openframe.services.web.struts.taglib.forms.fields.CheckboxFieldTag"&gt;<br/>
&lt;property name="i18nService" ref="i18nService"/&gt;<br/>
&lt;property name="validationService" ref="webValidationService"/&gt;<br/>
&lt;property name="layout" value="true"/&gt;<br/>
&lt;/bean&gt;</p>

<p>&lt;bean parent="checkboxFieldTag"&gt;<br/>
&lt;property name="styleId" value="lower18"/&gt;<br/>
&lt;property name="key" value="forms.accountForm.field.lower18"/&gt;<br/>
&lt;/bean&gt;</p>

<p>Configuració del Tag 'File'</p>

<p>Aquest tag permet especificar l'ús d'un fitxer de upload</p>

<p>Veure 'Servei de Upload de Fitxers' per a més referència de la configuració necessària.</p>

<p>El tag requereix que es configuri la propietat 'encType' del tag 'Form' amb el següent valor:</p>

<p><b>"multipart/form-data"</b></p>

<p>Exemple:</p>

<p>&lt;bean parent="fileFieldTag"&gt;<br/>
&lt;property name="styleId" value="file"/&gt;<br/>
&lt;property name="mode" value="E,I,I"/&gt;<br/>
&lt;property name="key" value="forms.fileForm.field.file"/&gt;<br/>
&lt;/bean&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-Configuraci%C3%B3delstagsdeLlistats"></a>Configuració dels tags de Llistats</h3>

<p>Veure document 'Servei de Llistats'.</p>

<h2><a name="TagsdePresentaci%C3%B3-Configuraci%C3%B3delstagsenelJSP"></a>Configuració dels tags en el JSP</h2>

<p>El nou servei de configuració permet definir totes les propietats de text o referències de components  en el JSP.  Això fa que no sigui necessari tenir definit un styleId que faci referència en el action-services-XXX.xml en la propietats tagsConfiguration de l'action.</p>

<p>Cal remarcar que per propietats complexes, com Maps o Lists, no es dona suport i necessàriament s'han d'escriure en els fitxers d'Spring i relacionar-les amb el styelId.</p>

<p>Aquesta utilitat simplifica el desenvolupament ja que es pot tenir configurat totes les dades del tag en el propi JSP sense necessitat d'haver d'escriure les propietats en fitxers Spring.</p>

<p>Per fer referències a components dins el tag JSP s'ha creat l'atribut <em>services</em> en tots el tags que permet especificar la propietat i la referència del component que se li ha d'injectar al tag.</p>

<p>Seguidament es mostra un exemple.</p>

<p>&lt;fwk:text styleId="password" layout="false" property="password"<br/>
services="i18nService:i18nService,validationService:webValidationService" /&gt;</p>

<p>En l'exemple anterior s'estan injectant els beans d'spring amb id 'i18nService' i 'webValidationService' en les propietats 'i18nService' i 'validationService' del tag, respectivament.</p>

<h2><a name="TagsdePresentaci%C3%B3-Tagsavan%C3%A7ats"></a>Tags avançats</h2>

<p>Aquests tags hi són a partir de la versió 1.1.</p>

<h3><a name="TagsdePresentaci%C3%B3-DirtyFormWarning"></a>Dirty Form Warning</h3>

<p>El dirty form warning és una funcionalitat que permet a l'usuari avisar quan es córrer el risc de perdre els canvis en un formulari.</p>

<p>Quan es clicka un link i produeix una descàrrega del formulari que té canvis, surt un missatge d'avís de pèrdua de les dades. Llavors l'usuari pot decidir que es procedeixi a la descàrrega del formulari per presentar una nova pàgina o decidir aturar l'acció per no perdre les dades.</p>

<p>L'event que s'escolta per llençar l'avís és el onBeforeUnload suportat per Internet Explorer 6 i FireFox 1.5.</p>

<p>El tag que dona aquesta funcionalitat és el dirtyFormWarning</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
openFrame-dirtyFormWarning-tag.js</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador per lligar amb configuració XML </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del formulari que és vol escoltar dels canvis. </td>
</tr>
<tr>
<td class='confluenceTd'> messageKey </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Clau internacionalitzada del missatge </td>
</tr>
<tr>
<td class='confluenceTd'> Message </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Text del missatge a mostrar </td>
</tr>
</tbody></table>
<p>Exemple d'ús:</p>

<p>&lt;fwk:dirtyFormWarning  source="actionForm" messageKey="errors.lostChanges"  /&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-SearchPanel"></a>Search Panel</h3>

<p>El panell de cerca és una utilitat que permet a l'usuari poder trobar el valor adient d'un camp.<br/>
La cerca és fa mitjançant mostrant un panell amb un camp per omplir dades a cercar i un botó per engegar la cerca. El resultat és mostra sota del camp de text.</p>

<p>El panell de cerca permet mostrar de les dades que compleixen la condició més dades relacionades. Per exemple si s'estan buscant cognoms de persones, el panell de cerca permet mostrar a part del cognom, el nom, el càrrec que ocupa, centre, etc  per tal d'ajudar a l'usuari a escollir correctament i en cas de repetició, poder discriminar.</p>

<p>Aquesta és la gran diferència amb l'autocomplete o els selects, que només mostren un dada en concret.</p>

<p>Les cerques es poden fer tantes com es vulguin, però un cop es seleccioni una dada, el panell s'amagarà. Si es torna a pitjar el botó de cercar, el panell de cerca tornarà a aparèixer amb les dades de la última cerca.</p>

<p>El tag que ofereix aquesta funcionalitat és el searchPanel</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
openFrame-ajaxtags-searchPanel.js</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador per lligar amb configuració XML </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic que escolarà l'event onClick per mostrar el panell. </td>
</tr>
<tr>
<td class='confluenceTd'> popupId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Identificador del div que conté el panell de cerca. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de text que es copiarà el valor seleccionat </td>
</tr>
<tr>
<td class='confluenceTd'> optionListName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Query que executa el panell. </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Estil CSS per aplicar al panell. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Identificador del div que es mostra al fer la petició a servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> tableProperties </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de les propietats del bean que es volen mostrar en la cerca </td>
</tr>
<tr>
<td class='confluenceTd'> selectedProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Propietat a copiar al target </td>
</tr>
<tr>
<td class='confluenceTd'> columnLabel </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Claus dels noms de les propietats internacionalitzades </td>
</tr>
<tr>
<td class='confluenceTd'> method </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Nom del mètode que s'encarregarà de fer la presentació, enlloc de fer la per defecte. </td>
</tr>
<tr>
<td class='confluenceTd'> queryParameter </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del paràmetre de la query. </td>
</tr>
<tr>
<td class='confluenceTd'> services </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Parelles de nom servei:servei . nom servei és l'atribut que conté el servei, i servei és el nom del servei en spring. </td>
</tr>
</tbody></table>
<ul>
	<li><b>popupId</b></li>
</ul>


<p>Identificador del div que conté el panell de cerques. Va bé per poder definir estils .</p>
<ul>
	<li><b>optionsListName</b></li>
</ul>


<p>Nom de la query a executar. Ha d'estar definida en openFrame-services-weblist.xml.</p>
<ul>
	<li><b>queryParameter</b></li>
</ul>


<p>Nom del paràmetre de la query que se li associarà el valor del camp entrat a buscar.</p>
<ul>
	<li><b>tableProperties</b></li>
</ul>


<p>Llista de propietats del bean que retorna la query. Es permeten propietats relacionades. Per exemple si la query retorna elements R i aquests tenen un relació L que conté elements C, es pot posar  L.id, que seria el id de l'element C associat.</p>
<ul>
	<li><b>selectedProperty</b></li>
</ul>


<p>Nom de la propietat del bean que retorna la query que es vol copiar al camp de text target.<br/>
Aquest propietat pot estar dins les tableProperties.</p>
<ul>
	<li><b>columnLabel</b></li>
</ul>


<p>Claus de multillenguatge pel nom de les columnes de la taula de resultats. El nombre de columnLabels i de tableProperties ha de ser igual. En cas de no ser-ho el searchPanel avisa del conflicte.</p>
<ul>
	<li><b>method</b></li>
</ul>


<p>Nom de mètode javascript que sap fer el pintat del resultats. Aquest paràmetre permet a l'usuari canviar l'aspecte de la presentació de resultats. Aquesta funció ha conèixer el format json que retorna servidor per poder presentar les dades.</p>

<p>Exemple:</p>

<p>openFrame-services-web-list.xml</p>

<p>&lt;bean name="valueListHandler"<br/>
class="net.mlw.vlh.DefaultValueListHandlerImpl"&gt;<br/>
&lt;property name="config.adapters"&gt;<br/>
&lt;map&gt;<br/>
&lt;entry key="accountList"&gt;<br/>
&lt;bean parent="baseHibernateAdapter"&gt;<br/>
&lt;property name="hql"&gt;<br/>
&lt;value&gt;<br/>
FROM<br/>
net.opentrends.openframe.samples.jpetstore.model.Account<br/>
AS vo WHERE 1=1<br/>
/~firstname: AND vo.firstname LIKE {firstname} &#126;/<br/>
/~lastname: AND vo.lastname LIKE {lastname} &#126;/<br/>
/<sub>sortColumn: ORDER BY vo.[sortColumn] [sortDirection]</sub>/<br/>
&lt;/value&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;<br/>
&lt;/entry&gt;<br/>
&lt;/map&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;</p>

<p>JSP:</p>

<p>&lt;input type="button" value="search" id="searchPanelButton" /&gt;<br/>
&lt;fwk:searchPanel<br/>
styleId="searchPanel"<br/>
source="searchPanelButton"<br/>
target="city"<br/>
popupId="searchPanelDiv"<br/>
optionsListName="accountList"<br/>
tableProperties="firstname,lastname,city"<br/>
selectedProperty="city"<br/>
columnLabels="name.label,lastname.label,city.label"<br/>
indicator="indicator"<br/>
queryParameter="firstname" /&gt;</p>

<p>Per fer servir el searchPanel s'han d'importar els següents scripts:</p>

<p>&lt;&#33;<del>&#45;  Search panel &#45;</del>&gt;<br/>
&lt;script<br/>
src="/openFrame-samples-jPetstore/scripts/ajax/ajaxtags/openFrame-ajaxtags-searchPanel.js"<br/>
type="text/javascript"&gt;<br/>
&lt;/script&gt;<br/>
&lt;script type='text/javascript'<br/>
src='/openFrame-samples-jPetstore/AppJava/dwr/interface/searchPanelService.js'&gt;&lt;/script&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-Autocomplete"></a>Autocomplete</h3>

<p>L'autocomplete permet a l'usuari mostrar una llista de suggeriments pel valor que ha escrit.<br/>
L'usuari clickant una de les opcions mostrades li evita escriure i li corrobora que la dada és correcte.</p>

<p>En el framework aquesta funcionalitat s'obté amb el tag autocomplete. Aquest autocomplete és importat de la llibreria ajaxtags 1.1 i s'ha adaptat perquè cridi al servei de cerques del framework i mostri correctament el resultat. Entre el servidor i client viatja una cadena json.</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
openFrame-ajaxtags-autocomplete.js</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic que escolarà l'event onKeyUp per mostrar els suggeriments. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de text que es copiarà el valor seleccionat </td>
</tr>
<tr>
<td class='confluenceTd'> optionListName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Query que executa el panell. </td>
</tr>
<tr>
<td class='confluenceTd'> className </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Estil CSS per aplicar al panell. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador del div que es mostra al fer la petició a servidor. </td>
</tr>
<tr>
<td class='confluenceTd'> minimumCharacters </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nombre de caràcters mínims per executar la query. </td>
</tr>
<tr>
<td class='confluenceTd'> errorFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció a cridar en cas d'error </td>
</tr>
<tr>
<td class='confluenceTd'> emptyFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció a cridar en cas de no haver resultats </td>
</tr>
<tr>
<td class='confluenceTd'> postFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció a cridar després de rebre dades. </td>
</tr>
</tbody></table>
<ul>
	<li><b>source</b></li>
</ul>


<p>Component gràfic que es vol escoltar els events de teclat per tal de mostrar un autocomplete.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Camp de text que es desitja copiar el valor seleccionat en l'autocomplete. Normalment serà igual que el source.</p>
<ul>
	<li><b>optionsListName</b></li>
</ul>


<p>Consulta definida en openFrame-services-web-options-list.xml</p>
<ul>
	<li><b>minimumCharacters</b></li>
</ul>


<p>Nombre de caràcters mínims en el camp de text origen per tal de disparar la consulta.</p>
<ul>
	<li><b>errorFunction</b></li>
</ul>


<p>Funció a executar en cas d'error de dades o de comunicació.</p>
<ul>
	<li><b>emptyFunction</b></li>
</ul>


<p>Funció a executar en cas d'element buit.</p>
<ul>
	<li><b>postFunction</b></li>
</ul>


<p>Funció a executar després de presentar les dades.</p>

<p>Exemple:</p>

<p>openFrame-services-web-options-list.xml</p>

<p>&lt;bean name="defaultOptionValueListHandler"<br/>
class="net.mlw.vlh.DefaultValueListHandlerImpl"&gt;<br/>
&lt;property name="config.adapters"&gt;<br/>
&lt;map&gt;<br/>
&lt;entry key="animalsList"&gt;<br/>
&lt;bean parent="defaultOptionBaseHibernateAdapter"&gt;<br/>
&lt;property name="hql"&gt;<br/>
&lt;value&gt;<br/>
FROM<br/>
net.opentrends.openframe.samples.jpetstore.model.Product<br/>
AS vo WHERE 1=1<br/>
/~name: AND vo.name LIKE {name} &#126;/<br/>
/~category: AND vo.category.id LIKE {category} &#126;/<br/>
/~sortColumn: ORDER	BY vo.[sortColumn] [sortDirection]~/<br/>
&lt;/value&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;<br/>
&lt;/entry&gt;<br/>
&lt;/map&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;</p>

<p>&lt;bean id="animalsOptionListSource" parent="defaultOptionListSource"&gt;<br/>
&lt;property name="optionListName" value="animalsList"/&gt;<br/>
&lt;property name="optionLabelName" value="name"/&gt;<br/>
&lt;property name="optionLabelProperty" value="id"/&gt;<br/>
&lt;/bean&gt;</p>

<p>&lt;bean id="optionsListService" class="net.opentrends.openframe.services.web.taglib.util.options.OptionsListServiceBase"&gt;<br/>
&lt;property name="optionsListSources"&gt;<br/>
&lt;map&gt;<br/>
&lt;entry key="animalsList"&gt;&lt;ref bean="animalsOptionListSource"/&gt;&lt;/entry&gt;	     &lt;/map&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;</p>

<p>JSP:</p>

<p>&lt;fwk:text styleId="preferredProduct2.id" styleClass="fieldtext" property="preferredProduct2.id" /&gt;</p>

<p>&lt;fwk:autocomplete<br/>
source="preferredProduct2.id" target="preferredProduct2.id"<br/>
parameters="preferredProduct2.id" className="autocomplete"<br/>
minimumCharacters="1" indicator="indicator"<br/>
optionsListName="animalsList" /&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-Botonsambimatges"></a>Botons amb imatges</h3>

<p>El tag fwk:button permet definir botons amb el contingut que és vulgui, entre d'altres per exemple amb taules, imatges, text, etc.</p>

<p>Aquest tag és basat amb l'element d'html button, que és nou en l'html 4.0.<br/>
La missió del tag és encapsular aquest element, oferint tots els serveis que dona l'especificació.</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del botó </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CSS del botó </td>
</tr>
<tr>
<td class='confluenceTd'> Tabindex </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Índex de tabulació </td>
</tr>
<tr>
<td class='confluenceTd'> Value </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camp valor </td>
</tr>
<tr>
<td class='confluenceTd'> Title </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Títol del botó </td>
</tr>
<tr>
<td class='confluenceTd'> Lang </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Dir </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Disabled </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Si està deshabilitat o no </td>
</tr>
</tbody></table>
<p>Events: onblur,onchange,onclick,ondbclick,onfocus,onkeydown,onkeypress,onkeyup,onmousedown,onmousemove,onmouseout,onmouseover,onmouseup</p>

<p>Exemple:</p>

<p>&lt;fwk:button styleId="desa" type="submit"&gt;<br/>
&lt;img src="&lt;c:url value="/images/save.jpg"/&gt;" /&gt;<br/>
&lt;fmt:message key="jsp.includes.submit" /&gt;<br/>
&lt;/fwk:button&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-TagSwapSelect"></a>Tag Swap Select</h3>

<p>Aquest component ofereix un tag que permeten moure o copiar elements entre dos selects múltiples.  El seu ús es ben senzill.</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
openFrame-options-tag.js</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic que escoltarà l'event onClick per fer l'acció configurada. </td>
</tr>
<tr>
<td class='confluenceTd'> action </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Acció, que pot ser MOVE o COPY </td>
</tr>
<tr>
<td class='confluenceTd'> scope </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Àmbit de l'acció. Pot ser ALL o SELECTED. </td>
</tr>
<tr>
<td class='confluenceTd'> fromSelect </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Select origen </td>
</tr>
<tr>
<td class='confluenceTd'> toSelect </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Select destí. </td>
</tr>
</tbody></table>
<ul>
	<li><b>source</b></li>
</ul>


<p>Component gràfic que se li associa a l'event de onClick l'acció configurada. Normalment serà un botó.</p>
<ul>
	<li><b>action</b></li>
</ul>


<p>La acció pot ser moure o copiar elements d'un select cap a un altre. Els possibles valors són COPY o MOVE.</p>
<ul>
	<li><b>scope</b></li>
</ul>


<p>Dades del select origen. Poden ser les dades seleccionades o totes. Els dos possibles valors són ALL o SELECTED</p>
<ul>
	<li><b>fromSelect</b></li>
</ul>


<p>Select origen de dades.</p>
<ul>
	<li><b>toSelect</b></li>
</ul>


<p>Select destí de dades.</p>

<p>Exemple:</p>

<p>&lt;&#33;<del>&#45; Selects &#45;</del>&gt;<br/>
&lt;fwk:select styleId="allAnimals" roperty="allAnimals" multiple="true" styleClass="multipleSelect" /&gt;<br/>
&lt;fwk:select styleId="hateAnimals" property="hateAnimals" multiple="true"<br/>
styleClass="multipleSelect" /&gt;</p>

<p>&lt;&#33;<del>&#45; Botons &#45;</del>&gt;<br/>
&lt;input type="button" id="moveAllRight" value="&gt;&gt;" lass="botonsswap" /&gt;<br/>
&lt;input type="button" id="moveRight" value="&gt;" class="botonsswap" /&gt;<br/>
&lt;input type="button" id="moveLeft" value="&lt;" class="botonsswap" /&gt;<br/>
&lt;input type="button" id="moveAllLeft" value="&lt;&lt;" class="botonsswap" /&gt;</p>

<p>&lt;&#33; &#45;&#45; decoradors de swap &#45;-&gt;<br/>
&lt;fwk:swapTag source="moveAllRight" scope="ALL" action="MOVE"                 		   fromSelect="allAnimals" toSelect="hateAnimals" /&gt;<br/>
&lt;fwk:swapTag source="moveRight" scope="SELECTED" action="MOVE"<br/>
fromSelect="allAnimals" toSelect="hateAnimals" /&gt;<br/>
&lt;fwk:swapTag source="moveAllLeft" scope="ALL" action="MOVE"<br/>
fromSelect="hateAnimals" toSelect="allAnimals" /&gt;<br/>
&lt;fwk:swapTag source="moveLeft" scope="SELECTED" action="MOVE"<br/>
fromSelect="hateAnimals" toSelect="allAnimals" /&gt;</p>

<p>L'exemple és la construcció de dos selects, amb quatre botons que permeten:<br/>
&#45; moveAllRight: mou totes les dades del select allAnimals al hateAnimals.<br/>
&#45; moveRight: mou les dades seleccionades del select allAnimals al hateAnimals.<br/>
&#45; moveAllLeft: mou totes les dades del select hateAnimals al allAnimals.<br/>
&#45; moveLeft: mou les dades seleccionades del select hateAnimals al allAnimals.</p>

<h3><a name="TagsdePresentaci%C3%B3-Pestanyes"></a>Pestanyes</h3>

<p>Aquest component està compost per dos tags que permeten la construcció de pestanyes (Tabs).</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
openFrame-ajaxtags-tabs.js</p>

<p>Els tags són els següents:</p>

<h4><a name="TagsdePresentaci%C3%B3-TabPanelTag"></a>TabPanelTag</h4>

<p>El tag TabPanelTag és el tag pare que s'encarrega de crear les pestanyes i divs ocults, on es guardarà el contingut de les pàgines de les diferents pestanyes. En el cos d'aquest tag és on definirem totes les pestanyes (TabPageTag).</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> panelStyleId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id del panell que contindrà totes les pestanyes. </td>
</tr>
<tr>
<td class='confluenceTd'> contentStyleId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Part comú de l'id dels divs de les pestanyes. </td>
</tr>
<tr>
<td class='confluenceTd'> currentStyleId </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la pestanya seleccionada. </td>
</tr>
</tbody></table>
<ul>
	<li><b>panelStyleId</b></li>
</ul>


<p>Aquesta propietat defineix l'id del panell pare contenidor dels divs de les pestanyes. Amb aquest id podrem canviar l'estil general dels tabs.</p>
<ul>
	<li><b>contentStyleId</b></li>
</ul>


<p>Part comú de l'id dels divs de les pestanyes. El tag pare crearà cada div amb un id diferent. Aquest id es formarà amb la propietat 'contentStyleId' + '_tab' + index. Aquest índex ve donat pel número de pestanya dins del tag pare (TabPanelTag).<br/>
Si per exemple donem a 'contentStyleId' el valor 'content' i definim 3 pestanyes, es crearan 3 divs amb els següents ids:<br/>
? content_tab0<br/>
? content_tab1<br/>
? content_tab2</p>
<ul>
	<li><b>currentStyleId</b></li>
</ul>


<p>Aquesta propietat defineix l'id del la pestanya que està activa (la seleccionada). Amb aquest id podrem definir l'estil de la pestanya activa.</p>

<p>Exemple:</p>

<p>&lt;fwk:tabPanel panelStyleId="pestanas"<br/>
contentStyleId="tabContent" currentStyleId="active"&gt;</p>

<h4><a name="TagsdePresentaci%C3%B3-TabPageTag"></a>TabPageTag</h4>

<p>El tag TabPageTag defineix una pàgina de les pestanyes. Aquest tag no té sentit si no es troba dins d'un tag TabPanelTag.<br/>
Les pestanyes poden ser, bàsicament, de dos tipus: client o servidor.<br/>
<b>?</b> Les clients ja tenen el contingut en els divs quan es carrega la pàgina.<br/>
<b>?</b> Les servidor tenen els divs buits, es carreguen mitjançant AJAX quan es selecciona&#42; &#42;la pestanya. Quan això succeeix, s'envia una petició al servidor i es carrega en contingut del div mitjançant Javascript i XmlHttpRequest, sense necessitat de recarregar la pàgina sencera.<br/>
En Internet Explorer, no es suporta que un formulari contingui un altra formulari dins. Llavors si la pestanya servidor conté un formulari i la plana actual ja en té un de general, donarà un error.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> linkStyleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Classe de la pestanya (per aplicar estils a la pestanya). </td>
</tr>
<tr>
<td class='confluenceTd'> isActive </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica si la pestanya és 'enabled' o no (disabled); </td>
</tr>
<tr>
<td class='confluenceTd'> existingDivId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del div on es troba el contingut de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> caption </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Títol de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> captionKey </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Clau que correspon al títol de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> defaultTab </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica el tab actiu per defecte. </td>
</tr>
<tr>
<td class='confluenceTd'> imageCaption </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica la ruta de la imatge que volem afegir a la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> imagePosition </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica posició de la imatge que volem afegir a la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> baseUrl </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Indica la url on trobem el contingut de la pestanya. </td>
</tr>
<tr>
<td class='confluenceTd'> parameters </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Paràmetres de la url. </td>
</tr>
</tbody></table>
<ul>
	<li><b>isActive</b></li>
</ul>


<p>Si el valor es 'false', la pestanya quedarà desactivada (disabled) i no es podrà seleccionar.</p>
<ul>
	<li><b>existingDivId</b></li>
</ul>


<p>Id del div on es troba el contingut de la pestanya. Això s'utilitza quan el contingut de la pestanya no es vol posar dins del cos (body) del tag de la pestanya (TabPageTag), sinó que es vol usar el contingut d'un altre div.</p>
<ul>
	<li><b>defaultTab</b></li>
</ul>


<p>Si el valor es 'true', la pestanya quedarà activada al carregar la pàgina. Només es pot definir una pestanya com a 'defaultTab'.</p>
<ul>
	<li><b>imageCaption</b></li>
</ul>


<p>Afegeix una imatge a la pestanya. Indica la ruta de la imatge que volem afegir. Per defecte posa la imatge a l'esquerra del títol(caption o captionKey) de la pestanya.</p>
<ul>
	<li><b>imagePosition</b></li>
</ul>


<p>Indica la posició de la imatge. Els possibles valors són:<br/>
? left<br/>
? right<br/>
Per defecte és 'left'.</p>
<ul>
	<li><b>baseUrl</b></li>
</ul>


<p>Només per pestanyes carregades mitjançant servidor. Indica la url on trobem el contingut de la pestanya. Aquesta url ha de retornar una jsp, que serà el contingut.</p>

<p>Exemple pestanya client:</p>

<p>&lt;fwk:tab captionKey="tabs.account.pestanya2"<br/>
styleClass="contingut_tab" linkStyleClass="pestanya2" imageCaption="/openFrame-samples-jPetstore/images/ast.gif"<br/>
imagePosition="right"&gt;</p>

<p>Exemple pestanya servidor:</p>

<p>&lt;fwk:tab captionKey="tabs.account.server"<br/>
styleClass="contingut_tab"<br/>
linkStyleClass="pestanya4"                                                                       baseUrl="accountList.do?reqCode=addRowEditList"/&gt;</p>

<p>Exemple complet:</p>

<p>&lt;fwk:tabPanel panelStyleId="pestanas"<br/>
contentStyleId="tabContent" currentStyleId="active"&gt;<br/>
&lt;fwk:tab captionKey="tabs.account.pestanya1" defaultTab="true"<br/>
styleClass="contingut_tab" linkStyleClass="pestanya1"<br/>
imageCaption="/openFrame-samples-jPetstore/images/asc.gif"&gt;<br/>
&lt;fwk:text styleId="firstname" styleClass="fieldtext"<br/>
property="firstname"&gt;<br/>
&lt;/fwk:tab&gt;<br/>
&lt;fwk:tab captionKey="tabs.account.pestanya2"<br/>
styleClass="contingut_tab" linkStyleClass="pestanya2" imageCaption="/openFrame-samples-jPetstore/images/ast.gif"<br/>
imagePosition="right"&gt;<br/>
&lt;fwk:text styleId="country" property="country"&gt;<br/>
&lt;/fwk:tab&gt;<br/>
&lt;fwk:tab captionKey="tabs.account.server"<br/>
styleClass="contingut_tab" linkStyleClass="pestanya4" baseUrl="accountList.do?reqCode=addRowEditList"/&gt;<br/>
&lt;/fwk:tabPanel&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-GridBagLayout"></a>GridBagLayout</h3>

<p>El tag de GridBagLayout és un component que permet la creació de taules que ofereixen un fàcil control de les propietats dels elements que continguin. Mitjançant la definició d'aquest Tag podrem controlar les propietats de cada cel?la (TD) individualment o conjuntament (amb les propietats de cada línia &#45;TR&#45; o de tota la taula &#45;TABLE-).</p>

<p>Per definir les propietats pròpies a la Taula, als TDs i als TRs, s'han de definir el el tag les propietats pròpies de les Taules, dels TDs i dels TRs:</p>

<p>Les propietats referents al component taula es definiran amb el seu nom i el prefix 'grid'. Així, si volem definir la propietat 'style' de la taula, definirem la propietat gridStyle en el tag:</p>

<p>gridStyle="border:1px solid black;"</p>

<p>Les propietats referents als components de la taula (TD i TR) es definiran amb el seu nom habitual. Per especificar a quina o quines cel?les es vol aplicar la propietat, es farà de la següent manera:</p>

<p>Si ens volem referir a una cel?la en concret, indicarem el número de fila i de columna que ocupa, separat pel caràcter ':'. Afegirem el valor de la propietat després el caràcter '=':</p>

<p>style="2:1=border:1px solid black"</p>

<p>Així, segons aquest exemple, la cel?la de la fila 2 columna 1 tindrà l'estil 'border:1px solid black'.</p>

<p>Si volem definir una propietat per més d'una cel?la, ho farem separant les definicions amb el caràcter ',':</p>

<p>style="2:1=border:1px solid black,2:2=background-color:blue"</p>

<p>Si volem definir una propietat per tota una fila o tota una columna, ho farem mitjançant el caràcter '*':</p>

<p>style="2:*=border:1px solid black "</p>

<p>En l'exemple anterior, l'estil definit s'aplicarà a tota la fila 2. En aquest cas, però, s'aplicarà l'estil a totes les cel?les (TDs) de la fila, no a l'element fila (TR). Si volem aplicar la propietat al TR, ho farem mitjançant '**':</p>

<p>style="2:**=border:1px solid black"</p>

<p>En aquest cas, l'estil s'aplicarà al TR de la fila 2. Això només ho podrem fer amb les files, ja que compten amb l'element TR. Per les columnes, només podrem aplicar '*', i l'estil s'aplicarà a tots els TDs de la columna individualment.</p>

<p>També podem definir alguna propietat per totes les cel?les de la taula mitjançant '<b>:</b>':</p>

<p>style="<b>:</b>=background-color:blue"</p>

<p>En aquest exemple s'aplica l'estil a tots els TDs de la taula. Si volem fer-ho amb tots els TRs, ho farem mitjançant '<b>:</b>&#42;':</p>

<p>style="<b>:</b>&#42;=background-color:blue"</p>

<p>La següent taula recull el diferents valors que hem definit per referir-nos a les cel.les:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'><ul>
	<li>Valor&#42;</li>
</ul>
</td>
<td class='confluenceTd'> <b>Definició</b> </td>
</tr>
<tr>
<td class='confluenceTd'> 1:1 </td>
<td class='confluenceTd'> Fila 1 columna 1 </td>
</tr>
<tr>
<td class='confluenceTd'> &#42;:1 </td>
<td class='confluenceTd'> Tots els TDs de la columna 1 </td>
</tr>
<tr>
<td class='confluenceTd'> 1:&#42; </td>
<td class='confluenceTd'> Tots els TDs de la fila 1 </td>
</tr>
<tr>
<td class='confluenceTd'> 1:*&#42; </td>
<td class='confluenceTd'> TR de la fila 1 </td>
</tr>
<tr>
<td class='confluenceTd'> &#42;:&#42; </td>
<td class='confluenceTd'> Tots els TDs de la taula </td>
</tr>
<tr>
<td class='confluenceTd'> &#42;:*&#42; </td>
<td class='confluenceTd'> Tots els TRs de la taula </td>
</tr>
</tbody></table>
<p>A més de les propietats pròpies a les Taules,TDs i TRs s'han incorporat les següents propietats:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> size </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Defineix el nombre de files i columnes que tindrà el grid: <br clear="all" />
Exemple: <br clear="all" />
size="2,3" &#45;&gt; Crearà 2 files i 3 columnes. </td>
</tr>
</tbody></table>
<p>El contingut de cada cel?la del grid el definirem en el cos del Tag GridBadLayout. Cada node que trobem serà el contingut de cada cel?la, tenint en compte l'ordre en que els anem trobant. Si volem que una cel?la contingui més d'un element, els haurem d'agrupar algun altre element (com, per exemple, un 'div' o un 'span'), ja que el tag parssejarà el seu contingut com si es tractés d'un document XML, posant en cada cel?la del grid el contingut de cada node de primer nivell:</p>

<p>&lt;fwk:gridBagLayout size="1,3"<br/>
gridBorder="1"<br/>
gridStyle="border:1px solid black;"<br/>
colspan="1:1=2"<br/>
rowspan="1:1=2"&gt;</p>

<p>&lt;span&gt;&lt;input type="text" name="text1" id="text1" value="text1"/&gt;&lt;/span&gt;<br/>
&lt;input type="text" name="gridText" id="gridText"/&gt;<br/>
&lt;span&gt;&lt;input type="text" name="gridT" id="gridT" value="gridT"/&gt;&lt;/span&gt;</p>

<p>&lt;/fwk:gridBagLayout&gt;</p>

<p>En l'exemple anterior, es crearà una taula amb una fila i 3 columnes. En la primera cel?la hi posarà el contingut del primer node del cos del tag:</p>

<p>&lt;span&gt;&lt;input type="text" name="text1" id="text1" value="text1"/&gt;&lt;/span&gt;</p>

<p>En la segona hi posarà el segon node:</p>

<p>&lt;input type="text" name="gridText" id="gridText"/&gt;</p>

<p>I, finalment, en la tercera, hi posarà el tercer i últim node:</p>

<p>&lt;span&gt;&lt;input type="text" name="gridT" id="gridT" value="gridT"/&gt;&lt;/span&gt;</p>

<p>? Errors de construcció del grid</p>

<p>Si en el contingut del tag hi tenim més elements que cel?les hem definit en l'atribut 'size', el tag llançarà una excepció. Si, en canvi, hi ha més cel?les que elements, el tag crearà les cel?les restants buides.</p>

<p>El tag suporta també les propietats 'colspan' i 'rowspan'. Aquestes propietats es defineixen quan una cel?la ha d'ocupar més una fila o d'una columna. Amb aquestes propietats es poden definir incongruències. En aquests casos, el tag llançarà excepcions. Aquestes incongruències poden ser:</p>

<p>&#42;? &#42;Definir una propietat fora de límits:<br/>
Això succeeix quan definim una propietat 'colspan' o 'rowspan' amb un valor que està fora dels límits del grid:</p>

<p>&lt;fwk:gridBagLayout size="1,3" colspan="1:3=2"&gt;<br/>
...</p>

<p>En l'exemple anterior, definim la propietat 'colspan' de la tercera i última columna cel?la del grid amb valor 2. Això només podria ser si el grid tingués 4 columnes. Així, el tag llançarà una excepció indicant el motiu de l'error.</p>

<p>&#42;?*Definir una propietat d'una cel?la que està solapada per la propietat 'colspan' o 'rowspan' d'una altra cel?la:</p>

<p>&lt;fwk:gridBagLayout size="1,3" colspan="1:1=2"<br/>
style="1:2=border:1px solid black"&gt;<br/>
...</p>

<p>En l'exemple anterior definim la propietat 'style' de la cel?la 1:2, però aquesta cel?la està solapada per la propietat 'colspan' de la cel.la 1:1. Així, el tag llançarà una excepció indicant l'error.</p>

<p><b>? Exemple complet de GridBagLayout</b></p>

<p>&lt;fwk:gridBagLayout size="3,3"<br/>
gridBorder="1"<br/>
gridStyle="border:1px solid black;"<br/>
colspan="1:1=2"<br/>
rowspan="1:1=2"<br/>
style="<b>:</b>=border:1px solid 								   black;,*:0=background-color:blue"<br/>
onmouseover="<b>:</b>&#42;=this.className='selected';"<br/>
onmouseout="<b>:</b>&#42;=this.className='zebra0';"&gt;</p>

<p>&lt;span&gt;&lt;input type="text" name="span1" id="span1" value="span1"/&gt;&lt;/span&gt;<br/>
&lt;input type="text" name="gridText" id="gridText"/&gt;<br/>
&lt;span&gt;&lt;input type="text" name="gridT" id="gridT" value=" gridT "/&gt;&lt;/span&gt;</p>

<p>&lt;span&gt;&lt;input type="text" name="span2" id="span2" value="span2"/&gt;&lt;/span&gt;<br/>
&lt;input type="text" name="gridText" id="gridText" value="gridText"/&gt;<br/>
&lt;span&gt;&lt;input type="text" name="gridT" id="gridT" value="gridT"/&gt;&lt;/span&gt;</p>

<p>&lt;/fwk:gridBagLayout&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-Paginaci%C3%B3deselects"></a>Paginació de selects</h3>

<p>El pagedSelect permet a l'usuari mostrar una llista paginada de suggeriments pel valor que ha escrit. Aquest només mostra un camp en concret, que és el que és copia al camp de text.<br/>
L'usuari clickant una de les opcions mostrades li evita escriure i li corrobora que la dada és correcte.</p>

<p>És molt útil per mostrar llistes suggeriments de molts elements, ja que té la paginació.</p>

<p>Aquest pagedSelect és importat de la llibreria ajaxtags 1.1 i s'ha adaptat perquè cridi al servei de cerques del framework i mostri correctament el resultat. Entre el servidor i client viatja una cadena json.</p>

<p>Dependències:</p>

<p>ajaxtags-1.1.jar<br/>
ajaxtags-openFrame-pagedSelect.js</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del component gràfic. </td>
</tr>
<tr>
<td class='confluenceTd'> selectedKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de la query que serà la clau de la option </td>
</tr>
<tr>
<td class='confluenceTd'> selectedValue </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Camp de la query que serà el valor de la option </td>
</tr>
<tr>
<td class='confluenceTd'> property </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del component. </td>
</tr>
<tr>
<td class='confluenceTd'> dependentFields </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camps amb el valor dels queryParameters </td>
</tr>
<tr>
<td class='confluenceTd'> queryParameters </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Paràmetres de la query </td>
</tr>
<tr>
<td class='confluenceTd'> optionsListName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la query </td>
</tr>
</tbody></table>
<ul>
	<li><b>styleId</b></li>
</ul>


<p>Id del component gràfic. Serveix per poder aplicar estils al component i poder-lo configurar a partir d'un xml (action-servlet-xxx.xml).</p>
<ul>
	<li><b>selectedKey</b></li>
</ul>


<p>Camp de la query que serà la clau de la option</p>
<ul>
	<li><b>selectedValue</b></li>
</ul>


<p>Camp de la query que serà el valor de la option</p>
<ul>
	<li><b>property</b></li>
</ul>


<p>Nom del component.</p>
<ul>
	<li><b>dependentFields</b></li>
</ul>


<p>Valor que tindran els paràmetres<br/>
Aquest camp contindrà tots els valors dels paràmetres de la query (queryParameters) separats per comes.</p>
<ul>
	<li><b>queryParameters</b></li>
</ul>


<p>Nom dels paràmetres dins la query. En la query es fa referència a aquests noms mitjançant la nomenclatura:</p>

<p>/~nomParametre: ... &#126;/</p>

<p>Aquest camp contindrà tots els paràmetres de la query separats per comes.</p>
<ul>
	<li><b>optionsListName</b></li>
</ul>


<p>Nom de la query. Aquesta query estarà definida dins de "openFrame-services-web &#45;list.xml".</p>

<p>Exemple:</p>

<p>openFrame-services-web-list.xml</p>

<p>&lt;bean name="valueListHandler"<br/>
class="net.mlw.vlh.DefaultValueListHandlerImpl"&gt;<br/>
&lt;property name="config.adapters"&gt;<br/>
&lt;map&gt;<br/>
&lt;entry key="categoriesList"&gt;<br/>
&lt;bean parent="baseHibernateAdapter"&gt;<br/>
&lt;property name="hql"&gt;<br/>
&lt;value&gt;<br/>
FROM<br/>
net.opentrends.openframe.samples.jpetstore.model.Category AS vo</p>

<p>WHERE 1=1<br/>
/~descn: AND vo.descn LIKE {descn} &#126;/<br/>
/<sub>sortColumn: ORDER BY vo.[sortColumn] [sortDirection]</sub>/<br/>
&lt;/value&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;<br/>
&lt;/entry&gt;<br/>
&lt;/map&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;</p>

<p>JSP:</p>

<p>&lt;input type="text" name="depValue" value="Birds"/&gt;</p>

<p>&lt;fwk:pagedSelect<br/>
styleId="preferredCategory.id"<br/>
selectedKey="id"<br/>
selectedValue="name"<br/>
property="preferredCategory.id"<br/>
dependentFields="depValue"<br/>
queryParameters="descn"<br/>
optionsListName="categoriesList"/&gt;</p>

<p>Exemple amb un sol resultat:</p>

<p>Exemple amb varis resultats (amb paginació):</p>

<h3><a name="TagsdePresentaci%C3%B3-Formatilimitaci%C3%B3d%27entradadedades"></a>Format i limitació d'entrada de dades</h3>

<p>Aquest component permet controlar el format i la limitació de l'entrada de dades d'un camp d'un formulari. Aquest component el podem utilitzar de dues maneres: mitjançant un decorador (<b>fwk:formatKeyStroke</b>) o directament en la configuració del tag text del Framework (<b>fwk:text</b>).</p>

<p>És molt habitual el seu ús en números de telèfon, targetes de crèdit, dates, etc.</p>

<p>Dependències:</p>

<p>masks.js</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> mask </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Màscara que es vol aplicar a un camp d'un formulari. </td>
</tr>
<tr>
<td class='confluenceTd'> maskType </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Tipus de màscara que es vol aplicar: text, date, number </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> &#42; </td>
<td class='confluenceTd'> Nom del component. </td>
</tr>
</tbody></table>
<ul>
	<li><b>mask</b></li>
</ul>


<p>Màscara que volem aplicar a un camp d'un formulari. Depenent del tipus de màscara seguirem un patró o un altre.</p>
<ul>
	<li><b>maskType</b></li>
</ul>


<p>Tipus de màscara. Pot ser de 3 tipus:</p>

<p>? Text: màscara de text.<br/>
Amb aquest tipus de màscara podem aplicar els següents patrons:</p>

<p>x: lletra [a-z].<br/>
X: lletra [A-Z].<br/>
&#35;: número [0-9].<br/>
&#42;: lletra o número [a-z][A-Z][0-9].</p>

<p>Qualsevol altre caràcter que aparegui a la màscara s'escriurà automàticament.</p>

<p>Exemple:</p>

<p>xxxx##  &#45;&gt; hola22<br/>
(###) #x*-####  &#45;&gt; (614) 7a7-6094<br/>
telf (##) ###.##.## &#45;&gt; telf (93) 311.34.89</p>

<p>? Date: màscara de data.<br/>
Amb aquest tipus de màscara podem aplicar els següents patrons:</p>

<p>d: dia [0-9].<br/>
m: mes [0-9].<br/>
y: any [0-9].</p>

<p>Exemples:</p>

<p>dd/mm/yyyy &#45;&gt; 24/05/1980<br/>
m/dd/yyyy  &#45;&gt; 2/05/1980<br/>
yyyy.mm.dd &#45;&gt; 1972.02.28</p>

<p>? Number: màscara numèrica.</p>

<p>$: indica la moneda (apareix automàticament).<br/>
&#35;: número [0-9].<br/>
0: número 0. S'utilitza pels decimals (apareix automàticament).<br/>
&#43;: Iindicador número positiu (apareix automàticament).<br/>
&#45;: Iindicador número negatiu (apareix automàticament).<br/>
,: Separador dels milers, milions, etc.. (apareix automàticament).<br/>
.: Indica on comencen els decimals.<br/>
(: principi parèntesis (apareix automàticament).<br/>
): fi parèntesis (apareix automàticament).</p>

<p>Exemples:</p>

<p>0#####.##  &#45;&gt; 000534.23<br/>
&#43;##,###.##  &#45;&gt; &#43;534.23<br/>
(-#,###.##)  &#45;&gt; (-534.23)</p>

<p>&#42; Per defecte el tipus de màscara és "text".</p>
<ul>
	<li><b>source</b></li>
</ul>


<p>Id del camp al qual volem aplicar la màscara. Només aplicable al decorador formatKeyStroke, ja que en el tag Text el camp al qual es vol aplicar la màscara és ell mateix.</p>

<p>Exemple amb decorador (fwk:formatKeyStroke):</p>

<p>&lt;fwk:text<br/>
styleId="firstname"<br/>
property="firstname"/&gt;</p>

<p>&lt;fwk:formatKeyStroke<br/>
source="firstname"<br/>
mask="xxxx##"/&gt;</p>

<p>Exemple sense decorador (fwk:text):</p>

<p>&lt;fwk:text<br/>
styleId="firstname"<br/>
property="firstname"<br/>
mask="xxxx##"/&gt;</p>

<h2><a name="TagsdePresentaci%C3%B3-Llistatseditables"></a>Llistats editables</h2>

<p>Els  llistats editables es basen en el suport de les propietats indexades. Per poder donar aquest suport s'han construït un seguit de tags per tal que es pugui fer un gestió correcte d'aquesta informació.</p>

<h3><a name="TagsdePresentaci%C3%B3-Introducci%C3%B3"></a>Introducció</h3>

<p>Una propietat indexada és:<br/>
&lt;fwk:text styleId="city" property="direccions[0].ciutat" /&gt;</p>

<p>Aquest camp mostra de la llista de direccions del bean pare, la ciutat de la primera direcció.</p>

<p>En la versió 1.0 openFrame sap renderitzar aquesta propietat, però no sap construir aquesta llista de direccions  en la baixada del submit dins el bean pare.</p>

<p>El problema principal que hi ha per construir la col?lecció de direccions, és que ningú coneix quins objectes ha de tenir dins. Per poder informar a openFrame d'aquesta tasca s'ha construït un tag anomenat <b>DefinePropertyTag</b>. Tota llista del bean que és vol materialitzar en la baixa és necessari que estigui definida amb aquest tag.</p>

<p>Les col?leccions editables poden provenir de moltes fonts.</p>

<p>Un cas típic es que en el load del bean del formulari es carreguin també seves col?leccions  per després mostrar en pantalla.</p>

<p>Un altra cas seria aquell on les  col?leccions  tenen molts elements. Aquí  és molt aconsellable fer servir la ValueList ja que  dona suport a la paginació, i navegació entre pàgines de manera amigable. La gran diferència amb el model primer, es que aquesta llista es carrega mitjançant una query definida en openFrame-web-lists.xml. Per tal que els tags de propietats indexades es renderitzin  correctament, s'ha de enganxar-li al bean del formulari la col?lecció que ha vingut de la valueList. Aquest enganxament es pot fer amb el <b>SetListTag</b>, on se li ha d'indicar quina és la propietat indexada del bean del form, i on és la llista ha afegir.</p>

<p>El suport a llistats editables també ofereix el poder afegir, seleccionar i esborrar elements d'un llistat. Aquests pressuposen que el llistat està contingut dins una table de HTML.</p>

<h3><a name="TagsdePresentaci%C3%B3-SetListTag"></a>SetListTag</h3>

<p>El tag SetListTag és un component que permet omplir els elements d'una llista del Bean d'un formulari amb els d'una llista que tenim guardada en qualsevol scope de la pàgina. Per exemple, si les dades provenen d'una valuelist, haurem d'omplir la llista del Form Bean amb la propietat 'list' de l'scope 'page':</p>

<p>&lt;fwk:setList listProperty="accounts" scopeKey="list" scope="page"/&gt;</p>

<p>Aquest exemple mostra com agafar la llista provinent de la ValueList i l'afegeix a la propietat accounts del bean del formulari.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> listProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> scopeKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Clau que té la llista en l'scope seleccionat. </td>
</tr>
<tr>
<td class='confluenceTd'> scope </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Scope on es troba la llista amb la clau definida a 'scopeKey'. </td>
</tr>
</tbody></table>
<ul>
	<li><b>listProperty</b></li>
</ul>


<p>Nom de la propietat indexada en el bean del formulari.</p>
<ul>
	<li><b>scopeKey</b></li>
</ul>


<p>Nom de la clau que conté la llista a afegir al bean del formulari.</p>
<ul>
	<li><b>scope</b></li>
</ul>


<p>Aquesta propietat només accepta 3 possibles valors:<br/>
? page<br/>
? request<br/>
? session</p>

<h3><a name="TagsdePresentaci%C3%B3-DefinePropertyTag"></a>DefinePropertyTag</h3>

<p>El tag DefinePropertyTag  serveix per informar a openFrame quins tipus de classe conté la col.lecció definir la classe que tenen els objectes continguts en la llista del Form Bean. Això es fa per poder fer el 'binding' dels nous objectes que es creïn a l'editar el llistat amb el Form Bean.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> listProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista del bean del formulari. </td>
</tr>
<tr>
<td class='confluenceTd'> itemsClass </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Classe dels objectes continguts en la llista del bena del formulari. </td>
</tr>
</tbody></table>
<p>&lt;fwk:defineProperty listProperty="accounts" itemsClass="net.opentrends.openframe.samples.jpetstore.model.Account"/&gt;</p>

<p>Aquest tag crearà dos inputs ocults amb el següent format:</p>

<p><em>&lt;input type="hidden" name="</em><em>Metadata.nom_llista. itemsClass</em><em>" value="classe_items_llista"/&gt;</em><br/>
<em>&lt;input type="hidden" name="</em><em>Metadata.nom_llista. lastIndex</em><em>" value="tamany_llista"/&gt;</em></p>

<p>Exemple:</p>

<p>&lt;input type="hidden" name="&#95;<em>Metadata.accounts.itemsClass</em>&#95;" value="net.openframe.samples.model.Account"/&gt;<br/>
&lt;input type="hidden" name="&#95;<em>Metadata.accounts.lastIndex</em>&#95;" value="2"/&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-SelectionTag"></a>SelectionTag</h3>

<p>El tag SelectionTag  serveix per seleccionar i deseleccionar tots els elements d'un llistat editable.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> listName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> selectionProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la propietat de selecció. </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de l'element disparador de l'event. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la taula que conté el llista editable </td>
</tr>
<tr>
<td class='confluenceTd'> action </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Acció de selecció o deselecció. </td>
</tr>
</tbody></table>
<ul>
	<li><b>selectionProperty</b></li>
</ul>


<p>Aquesta propietat defineix el camp del Form Bean que indicarà si el registre al qual pertany està seleccionat. El camp ha de ser un valor booleà i es representarà amb un element 'checkbox'.</p>
<ul>
	<li><b>source</b></li>
</ul>


<p>Aquesta propietat defineix l'id de l'element al qual s'hi s'assignarà l'event 'onclick' que dispararà la funció de seleccionar o deseleccionar tots els 'checkbox' de la taula.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Els llistats editables es faràn sobre taules. La taula que contingui els registres haurà de tenir un id. Aquest id és el que hem d'indicar en la propietat 'target'.</p>
<ul>
	<li><b>selectionProperty</b></li>
</ul>


<p>Acció que s'ha d'executar. Els possibles valors són:<br/>
? selectAll (seleccionar tots els registres)<br/>
? unselectAll (deseleccionar tots els registres)</p>

<p>Un exemple de la seva utilització podria ésser el següent:</p>

<p>&lt;fwk:selection source="selectionButton" target="taulaId" listName="accounts" selectionProperty="selected" action="selectAll"/&gt;<br/>
&lt;fwk:selection source="unselectionButton" target="taulaId" listName="accounts" selectionProperty="selected" action="unselectAll"/&gt;</p>

<p>En l'exemple anterior s'assigna a 2 botons (selectionButton i unselectionButton)  les funcions de seleccionar i deseleccionar tots els registres de la taula (amb id 'taulaId') respectivament.</p>

<h3><a name="TagsdePresentaci%C3%B3-DeleteRowsTag"></a>DeleteRowsTag</h3>

<p>El tag DeleteRowsTag serveix per eliminar els elements seleccionats d'un llistat editable.</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> listName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> selectionProperty </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la propietat de selecció. </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de l'element disparador de l'event. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la taula que conté el llista editable. </td>
</tr>
</tbody></table>
<ul>
	<li><b>selectionProperty</b></li>
</ul>


<p>Aquesta propietat defineix el camp del Form Bean que indicarà si el registre al qual pertany està seleccionat. El camp ha de ser un valor booleà i es representarà amb un element 'checkbox'. Tots els 'checkbox'  seleccionats indicaran els registres a esborrar.</p>
<ul>
	<li><b>source</b></li>
</ul>


<p>Aquesta propietat defineix l'id de l'element al qual s'hi s'assignarà l'event 'onclick' que dispararà la funció de esborrar tots els registres seleccionats.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Id de la taula on s'esborraran els registres.</p>

<p>Exemple:</p>

<p>&lt;fwk:deleterows source="deleteRowsButton" target="taulaId" listName="accounts" selectionProperty="selected"/&gt;</p>

<p>En l'exemple anterior s'assigna al botó amb id 'deleteRowsButton'  la funció d'eliminar tots els registres seleccionats de la taula.</p>

<h3><a name="TagsdePresentaci%C3%B3-AddRowTag"></a>AddRowTag</h3>

<p>El tag AddRowTag serveix per afegir nous registres a un llistat editable.</p>

<p>Funcionament</p>

<p>Aquest  fa una única petició a servidor d'obtenir la plantilla de fila nova. En aquesta es podran posar en els camps el valors per defecte de cada camp.</p>

<p>Aquesta petició es fa amb el reqCode addRowEditList. Si l'action hereta del DispatchActionSuport en té un de genèric. Aquest construeix el bean pare buit amb la col.lecció indexada amb un element buit, i llavors fa el forward indicat per a que es construeixi la plantilla de fila nova. Aquest mètode es pot redefinit per tal que es creï un element dins la col?lecció amb els valors per defecte desitjats.</p>

<p>La plantilla de fila nova té unes característiques especials.</p>

<p>Les propietats indexades han de fer referència a l'element 0 de la col?lecció. Això és causa ja que openFrame abans de renderitzar la plana omple la col?lecció amb un bean buit. Si és fes referència a un element superior a 0 en la plantilla sortirà una excepció.</p>

<p>La variable {rowIndex} es reemplaça just en el pintat per la posició que ocupar en la llista indexada del bean. És molt útil per poder fer referència a component dins la mateixa fila, com és el cas de les validacions.</p>

<p>Per tal que els components caixes de text es pintin és necessita que estiguin dins un formulari. I aquest tingui dins un table amb un tr, que és el que es pintarà com a plantilla de fila nova.</p>

<p>Per tal que les validacions obligatòries de submit funcionin, es necessita que aquest formulari tingui el mateix identificador intern que el que conté el llistat editable. Per fer això s'ha d'afegir al formulari de la plantilla nova el següent:</p>

<p> <b>generateId="&lt;%=request.getParameter("formIdent")%&gt;"</b></p>

<p>Un cop el navegador té la plantilla de fila nova del servidor, a cada petició d'afegir fila nova el que fa és copia aquesta plantilla i li reemplaça la propietat indexada amb el valor 0 pel que li correspon en aquell moment en el llistat editable.</p>

<p>Propietats del tag</p>

<p>Les propietats d'aquest tag són les següents:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> listName </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de la llista en el Form Bean. </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom de l'element disparador de l'event. </td>
</tr>
<tr>
<td class='confluenceTd'> target </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Id de la taula que conté el llista editable. </td>
</tr>
<tr>
<td class='confluenceTd'> insertInRow </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Posició dins la taula en la qual volem afegir els nous registres. </td>
</tr>
<tr>
<td class='confluenceTd'> startIndex </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Índex a partir del qual afegirem nous registres en la llista. </td>
</tr>
<tr>
<td class='confluenceTd'> url </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Url on es troba l'action que retornarà la jsp que conté la plantilla del TR a afegir. </td>
</tr>
<tr>
<td class='confluenceTd'> reqCode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Nom de la funció dins l'Action indicada en la propietat 'url'. </td>
</tr>
<tr>
<td class='confluenceTd'> parameters </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Paràmetres addicionals per afegir a la url. </td>
</tr>
<tr>
<td class='confluenceTd'> forward </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Nom del forward que s'executarà en la funció de la Action. </td>
</tr>
</tbody></table>
<ul>
	<li><b>source</b></li>
</ul>


<p>Aquesta propietat defineix l'id de l'element al qual s'assignarà l'event 'onclick' que dispararà la funció d'afegir un nou registre.</p>
<ul>
	<li><b>target</b></li>
</ul>


<p>Id de la taula on es crearan els nous registres.</p>
<ul>
	<li><b>insertInRow</b></li>
</ul>


<p>Posició gràfica de la taula on afegirem les noves plantilles. Els possibles valors poden ser:<br/>
? first<br/>
? second<br/>
? third<br/>
? last<br/>
? penultimate<br/>
? qualsevol nombre enter, tenint en compte que 0 és la primera posició i que les nombres negatius són el número de fila començant pel final de la taula. Així, si la propietat val &#45;1, s'afegiran els nous registres a la penúltima posició de la taula, si val &#45;2, l'avantpenúltima, etc..</p>
<ul>
	<li><b>startIndex</b></li>
</ul>


<p>Índex de la propietat indexada a partir del qual s'aniran renombrant les noves files. Lo més habitual és que l'startIndex sigui el nombre d'elements de lllista. Com que normalment no es sap s'ha d'emprar un variable que faci de comptador dins el jsp.</p>

<p>url</p>

<p>Els nous registres(o TRs) que s'han d'afegir a la taula es crearan a partir una plantilla. Aquesta plantilla serà una jsp on les propietats indexades sempre tindran index 0. El tag ja s'encarregarà de substituir el 0 per l'índex apropiat. La propietat 'url' indica la Action on es troba aquesta jsp, que contindrà una taula amb el TR que vulguem definir i que haurà de tenir la mateixa estructura que tots els altres registres (o <ins>TRs</ins>) de la taula.<br/>
Exemple:</p>

<p>&lt;table&gt;<br/>
&lt;tr onmouseover="this.className='selected';" onmouseout="this.className='zebra0';"&gt;<br/>
&lt;td&gt;<br/>
&lt;input type="checkbox" name="accounts[0].selected"/&gt;<br/>
&lt;/td&gt;<br/>
&lt;td&gt;<br/>
&lt;input type="text" name="accounts[0].lastname"/&gt;<br/>
&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>
&lt;/table&gt;</p>

<p>En l'exemple anterior definim una taula que conté la plantilla dels nous registres. Si en el tag hem informat la propietat 'startIndex' amb el valor 2, en afegir un nou registre el tag substituirà 'accounts[0]' per 'accounts[2]'; si n'afegim un altre, ho farà per 'accounts[3]', etc..</p>
<ul>
	<li><b>reqCode</b></li>
</ul>


<p>Nom de la funció dins la Action definida en 'url' que gestionarà l'enviament de la plantilla jsp.</p>
<ul>
	<li><b>forward</b></li>
</ul>


<p>Nom del forward que envia la plantilla jsp. Per defecte serà 'success'.</p>

<p>Exemple:</p>

<p>&lt;fwk:addrow url="/openFrame-samples-jPetstore/AppJava/accounts.do"<br/>
target="taulaId"<br/>
source="triggerButton"<br/>
listName="accounts"<br/>
startIndex="${count}"<br/>
insertInRow="penultimate"<br/>
reqCode="addRowEditList"/&gt;</p>

<p>En l'exemple anterior s'assigna al botó amb id 'triggerButton'  la funció d'afegir els nous registres de la taula.</p>

<p>Exemple complet de llistat editable amb valuelist:</p>

<p>&lt;%@ include file="/WEB-INF/jsp/includes/fwkTagLibs.jsp" %&gt;<br/>
&nbsp;&lt;br&gt;<br/>
&lt;script src="/openFrame-samples-jPetstore/scripts/ajax/ajaxtags/openFrame-ajaxtags-editList.js"            type="text/javascript"&gt;&lt;/script&gt;<br/>
&lt;script src="/openFrame-samples-jPetstore/scripts/ajax/json/json.js"            type="text/javascript"&gt;&lt;/script&gt;</p>

<p>&lt;c:set var="count" value="0"/&gt;</p>

<p>&lt;fwk:vlhroot value="list" url="accounts.do?" includeParameters="reqCode" configName="vlConfig"&gt;<br/>
&lt;fwk:form styleId="actionForm" action="accounts.do" reqCode="search"&gt;<br/>
&lt;fwk:setList listProperty="accounts" scopeKey="list" scope="page"/&gt;<br/>
&lt;fwk:defineProperty listProperty="accounts" itemsClass="net.opentrends.openframe.samples.jpetstore.model.Account"/&gt;</p>

<p>&lt;table width="450" align="center" border="0"&gt;<br/>
&lt;&#33;<del>&#45; pagination section &#45;</del>&gt;<br/>
&lt;tr&gt;<br/>
&lt;td align="left" nowrap="true"&gt;&lt;c:out<br/>
value="${list.valueListInfo.totalNumberOfEntries}" /&gt; &lt;fmt:message key="jsp.accounts.accountList.total"/&gt; - &lt;fmt:message key="jsp.accounts.accountList.page"/&gt;<br/>
(&lt;c:out value="${list.valueListInfo.pagingPage}" /&gt; &lt;fmt:message key="jsp.accounts.accountList.of"/&gt; &lt;c:out<br/>
value="${list.valueListInfo.totalNumberOfPages}" /&gt;)&lt;/td&gt;<br/>
&lt;td &gt;&lt;table border="0" align="right"&gt;&lt;tr&gt;&lt;td&gt;&lt;fwk:vlhpaging  /&gt;&lt;/td&gt;&lt;/table&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>
&lt;&#33;<del>&#45; end of Pagination &#45;</del>&gt;<br/>
&lt;tr&gt;<br/>
&lt;td colspan="2"&gt;<br/>
&lt;table width="100%" class="classicLook" cellspacing="0"<br/>
cellpadding="0" id="taulaId"&gt;<br/>
&lt;tbody&gt;<br/>
&lt;%<br/>
String displayProvider = (request.getAttribute("displayProvider")&#33;=<b>null</b>)?request.getAttribute("displayProvider").toString():"";<br/>
%&gt;<br/>
&lt;fwk:vlhrow bean="account" display="&lt;%=displayProvider%&gt;"&gt;</p>

<p>&lt;vlh:attribute name="onmouseover"&gt;this.className='selected';&lt;/vlh:attribute&gt;<br/>
&lt;vlh:attribute name="onmouseout"&gt;this.className='zebra0';&lt;/vlh:attribute&gt;<br/>
&lt;fwk:vlhcolumn titleKey="jsp.accounts.accountList.lastname" property="lastname"&gt;<br/>
&lt;fwk:checkbox property="accounts[${count}].selected" styleId="accounts[${count}].selected" layout="false"/&gt;<br/>
&lt;/fwk:vlhcolumn&gt;<br/>
&lt;fwk:vlhcolumn titleKey="jsp.accounts.accountList.id" property="id"&gt;<br/>
&lt;fwk:vlhaction url="editAccount.do?"&gt;<br/>
&lt;fwk:vlhaddParam name="reqCode" value="edit" temp="false" /&gt;<br/>
&lt;fwk:vlhaddParam name="id" property="id" temp="false" /&gt;<br/>
&lt;c:out value="${account.id}"&gt;&lt;/c:out&gt;<br/>
&lt;/fwk:vlhaction&gt;<br/>
&lt;/fwk:vlhcolumn&gt;<br/>
&lt;fwk:vlhcolumn titleKey="jsp.accounts.accountList.firstname" property="firstname"/&gt;<br/>
&lt;fwk:vlhcolumn titleKey="jsp.accounts.accountList.lastname" property="lastname"&gt;<br/>
&lt;fwk:text property="accounts[${count}].lastname" styleId="accounts[${count}].lastname" layout="false"/&gt;<br/>
&lt;/fwk:vlhcolumn&gt;<br/>
&lt;fwk:vlhcolumn titleKey="forms.accountForm.field.preferredCategory" property="preferredCategory.id"&gt;<br/>
&lt;fwk:select styleId="preferredCategory.id" property="preferredCategory.id"/&gt;<br/>
&lt;/fwk:vlhcolumn&gt;<br/>
&lt;c:set var="count" value="${count + 1}"/&gt;<br/>
&lt;/fwk:vlhrow&gt;<br/>
&lt;tr&gt;<br/>
&lt;td colspan="4" style="text-align:right"&gt;<br/>
&lt;table align="right"&gt;&lt;tr&gt;&lt;td style="border: 0px"&gt;&lt;fmt:message key="jsp.common.export"/&gt;&nbsp;&lt;/td&gt;<br/>
&lt;td style="border: 0px"&gt;&lt;html:link page="/accounts.do?reqCode=searchExportPDF" target="_blank"&gt;&lt;img src="&lt;%=request.getContextPath()%&gt;/images/icono_acrobat.gif"            border="0"/&gt;&lt;/html:link&gt;&lt;/td&gt;<br/>
&lt;td style="border: 0px"&gt;&lt;html:link page="/accounts.do?reqCode=searchExportExcel" target="_blank"&gt;&lt;img src="&lt;%=request.getContextPath()%&gt;/images/icono_excel.gif"            border="0"/&gt;&lt;/html:link&gt;&lt;/td&gt;<br/>
&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>
&lt;/tbody&gt;<br/>
&lt;/table&gt;<br/>
&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>
&lt;/table&gt;</p>

<p>&lt;input type="button" name="triggerButton" id="triggerButton" value="Add Row"/&gt;<br/>
&lt;input type="button" name="selectionButton" id="selectionButton" value="Select All"/&gt;<br/>
&lt;input type="button" name="unselectionButton" id="unselectionButton" value="Unselect All"/&gt;<br/>
&lt;input type="button" name="deleteRowsButton" id="deleteRowsButton" value="Delete selecteds"/&gt;</p>

<p>&lt;br&gt;</p>

<p>&lt;fwk:selection source="selectionButton" target="taulaId" listName="accounts" selectionProperty="selected" action="selectAll"/&gt;<br/>
&lt;fwk:selection source="unselectionButton" target="taulaId" listName="accounts" selectionProperty="selected" action="unselectAll"/&gt;</p>

<p>&lt;fwk:deleterows source="deleteRowsButton" target="taulaId" listName="accounts" selectionProperty="selected"/&gt;</p>

<p>&lt;fwk:addrow url="/openFrame-samples-jPetstore/AppJava/accounts.do"<br/>
target="taulaId"<br/>
source="triggerButton"<br/>
listName="accounts"<br/>
startIndex="${count}"<br/>
insertInRow="penultimate"<br/>
reqCode="addRowEditList"/&gt;</p>

<p>&lt;fwk:submit value="submit" styleId="submit" reqCode="save"/&gt;</p>

<p>&lt;/fwk:form&gt;<br/>
&lt;/fwk:vlhroot&gt;</p>

<h2><a name="TagsdePresentaci%C3%B3-Serveidevalidacionseneljsp"></a>Servei de validacions en el jsp</h2>

<p>El dividirem en dos gran àrees. La primera serà el motor de regles, i la segona el servei de presentació de missatges d'error.</p>

<h3><a name="TagsdePresentaci%C3%B3-Motorderegles"></a>Motor de regles</h3>

<p>El motor de regles és el conjunt de mètodes que permeten validar si les dades són correctes.<br/>
Aquestes s'han de poder executar tant en client com en servidor.</p>

<h4><a name="TagsdePresentaci%C3%B3-Definici%C3%B3deregles"></a>Definició de regles</h4>

<p>Per definir les regles de validació és fa servir el framework commons-validator 1.3.0 d'Apache.<br/>
En el framework es poden veure definides en el fitxer validations-rules.xml.</p>

<p>&lt;validator name="maxlength"<br/>
classname="org.springmodules.validation.commons.FieldChecks"<br/>
method="validateMaxLength"<br/>
methodParams="java.lang.Object,<br/>
org.apache.commons.validator.ValidatorAction,<br/>
org.apache.commons.validator.Field,<br/>
org.springframework.validation.Errors"</p>

<p>depends=""<br/>
msg="errors.maxlength"&gt;</p>

<p>&lt;javascript&gt;&lt;&#33;[CDATA[<br/>
function validateMaxLength(form) {<br/>
var isValid = true;<br/>
var focusField = null;<br/>
var i = 0;<br/>
var fields = new Array();<br/>
oMaxLength = new maxlength();<br/>
for (x in oMaxLength) {<br/>
var field = form[oMaxLength[x][0]];</p>

<p>// openFrame modification. Added if. In some cases, a 'extend'<br/>
// field appears that is not a field.<br/>
if (field) {</p>

<p>if (field.type == 'text' &#124;&#124;<br/>
field.type == 'textarea') {</p>

<p>var iMax = parseInt(oMaxLength[x][2]("maxlength"));<br/>
if (field.value.length &gt; iMax) {<br/>
if (i == 0) {<br/>
focusField = field;<br/>
}<br/>
fields[i++] = oMaxLength[x][1];<br/>
isValid = false;<br/>
}<br/>
}<br/>
}<br/>
}<br/>
if (fields.length &gt; 0) {<br/>
focusField.focus();<br/>
alert(fields.join('\n'));<br/>
}<br/>
return isValid;<br/>
}]]&gt;<br/>
&lt;/javascript&gt;</p>

<p>&lt;/validator&gt;</p>

<p>Les regles que tenen definida la funció javascript permeten l'execució en client, però sempre han de tenir la implementació en java per garantir l'execució en servidor.</p>

<p>Les regles poden dependre d'un o més camps. Aquelles que necessiten més d'un camps per validar en direm que són regles amb camps dependents. Per tant se li ha d'indicar d'alguna manera aquesta necessitat. Amb el commons-validator és fa mitjançant passant-li els valors dels camps com argument, en canvi amb el nou tag de validacions s'indica amb un atribut a mida.</p>

<h4><a name="TagsdePresentaci%C3%B3-Eventsdevalidaci%C3%B3"></a>Events de validació</h4>

<p>Els events que llencen el sistema de validació són els següents:</p>

<p><b>&#45; onSubmit del formulari:</b></p>

<p>Quan es fa un submit del formulari és llença una petició de validació via AJAX cap a servidor o s' executa regles de javascipt si es validació client . Si aquesta és correcta es fa el submit.</p>

<p>Per qüestions de seguretat, quan es fa el submit en servidor es torna a validar les dades que són les que entraran a l'action. Per exemple si es desactivés el javascript les validacions AJAX no funcionarien, però al  baixar les dades és validaran per les validacions obligatòries de submit.</p>

<p>Aquestes validacions de submit obligatòries són configurables i pots establir quin mètodes han de tenir validacions obligatòries.</p>

<p>&lt;bean name="/accountList" parent="accountListBaseDefinition"&gt;<br/>
&lt;property name="webValidationSubmit" ref="webValidationSubmit"/&gt;<br/>
&lt;property name="metodosList"&gt;<br/>
&lt;list&gt;<br/>
&lt;value&gt;save&lt;/value&gt;<br/>
&lt;/list&gt;<br/>
&lt;/property&gt;<br/>
&lt;/bean&gt;</p>

<p>En l''action accountList s'ha definit que hi ha validacions obligatòries de submit pel mètode save de l'action.</p>

<p>Les regles a executar per un formulari és defineixen en el validation.xml</p>

<p>&lt;form name="accountList"&gt;<br/>
&lt;field property="firstname" depends="required"&gt;<br/>
&lt;arg0 key="forms.accountForm.field.firstname"/&gt;<br/>
&lt;/field&gt;<br/>
&lt;field property="lastname" depends="required"&gt;<br/>
&lt;arg0 key="forms.accountForm.field.firstname"/&gt;<br/>
&lt;/field&gt;</p>

<p>&lt;/form&gt;</p>

<p>El conjunt de regles anomenades accountList obliguen ha tenir el camp firstname i lastname informats.</p>

<p>Altrament aquesta seria la manera antiga. Amb la nova versió és permet definir les validacions de submit d'un camp en el mateix tag del jsp. Aquesta manera és més flexible i es poden veure fàcilment les validacions d'una pàgina.</p>

<p>Un exemple és :</p>

<p>&lt;fwk:text styleId="firstname" styleClass="fieldtext"<br/>
property="firstname" validations="ONSUBMIT(required)" /&gt;</p>

<p>&lt;fwk:text styleId="lastname" styleClass="fieldtext"<br/>
property="lastname"	  validations="ONSUBMIT(required)"/&gt;</p>

<p>Aquest exemple és sinònim de l'anterior.</p>

<p>A l'atribut validations es posa ONSUBMIT( &lt; regla de validació &gt;, &lt; regla de validació &gt; ..)  on les regles de validacions han d'estar definides en el validation-rules.xml.</p>

<p><b>&#45; onChange d'un camp de text:</b></p>

<p>Aquest event permet validar el contingut d'un camp un cop ha canviat. Són el que s'anomenen les validacions de camp.</p>

<p>Aquestes validacions només permeten execució de regles en servidor, mitjançant petició AJAX.<br/>
Al produir-se l'event onChange del camp, es llença petició a servidor indicant quin camp s'ha de validar i les regles de validació a aplicar.<br/>
En el cas que tingués camps dependents, s'enviarà el valor d'aquests camps.</p>

<p>La manera d'expressar aquestes validacions és:</p>

<p>&lt;fwk:text styleId="lastname" styleClass="fieldtext"<br/>
property="lastname" validationFieldMessageMode="ICON,TEXTERROR"<br/>
validations="ONCHANGE(required) "<br/>
errorClass="errorNew" errorKey="forms.accountForm.field.lastname"<br/>
iconStyleId="lastnameIconError"<br/>
textErrorStyleId="lastnameTextError" /&gt;</p>

<p>Escrivint ONCHANGE(..&lt;regla de validació&gt;, &lt;regla de validació&gt;) en l'atribut validations és defineix les validacions camp a camp. Aquestes regles de validació han d'estar definides en el fitxer validation-rules.xml.</p>

<p>Els altres atributs serveixen per mostrar l'avís d'error que seguidament s'explicarà en el següent apartat.</p>

<h3><a name="TagsdePresentaci%C3%B3-Presentaci%C3%B3demissatges"></a>Presentació de missatges</h3>

<p>Principalment són quatre tags, dos per validacions camp a camp i els altres dos per validacions de formulari.</p>

<h4><a name="TagsdePresentaci%C3%B3-FormiFormValidator"></a>Form i FormValidator</h4>

<p>El FormValidator és un decorador que permet associar a un formulari validacions. Els atributs dels dos són bastant semblants per tant s'explicaran junts.</p>

<p><b>fwk:Form</b>: Només s'exposen atributs de validació.</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> validationFormMessageMode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser PANEL, FIELDS, WINDOW </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div que es mostra quan es fa petició AJAX </td>
</tr>
<tr>
<td class='confluenceTd'> mode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CLIENT  o SERVIDOR </td>
</tr>
<tr>
<td class='confluenceTd'> generateId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del formulari intern. </td>
</tr>
<tr>
<td class='confluenceTd'> errorPanelStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del panell d'errors. </td>
</tr>
</tbody></table>
<p><b>fwk:FormValidator:</b></p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> source </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Formulari a associar-li validacions. </td>
</tr>
<tr>
<td class='confluenceTd'> validationFormMessageMode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser PANEL, FIELDS, WINDOW </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div que es mostra quan es fa petició AJAX </td>
</tr>
<tr>
<td class='confluenceTd'> mode </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CLIENT  o SERVIDOR </td>
</tr>
<tr>
<td class='confluenceTd'> errorPanelStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Id del panell d'errors. </td>
</tr>
</tbody></table>
<ul>
	<li><b>validationFormMessageMode</b></li>
</ul>


<p>Indica  les maneres de mostrar els errors de formulari. Hi ha 3 maneres possibles.<br/>
PANEL: Panell incrustat en la pàgina.<br/>
WINDOW: Mostra un alert amb els missatge d'error<br/>
FIELDS: Mostra els errors com si fos un validació camp a camp.</p>

<p>Es poden combinar els tres elements, encara que PANEL i WINDOW poden semblar contradictori, com per exemple PANEL,FIELDS;WINDOW o PANEL,FIELDS.</p>
<ul>
	<li>&#42;validationMessageFuncti*on</li>
</ul>


<p>Funció javascript que s'encarrega de fer la presentació del errors. Aquest és pels usuaris que volguessin fer un presentació d'errors a mida.</p>
<ul>
	<li><b>indicator</b></li>
</ul>


<p>Div que es mostra mentre s'està fent petició a servidor via AJAX.</p>
<ul>
	<li><b>mode</b></li>
</ul>


<p>Aquest atribut és necessari per quan no estant configurades les validacions del commons validator i només hi ha validacions dels tags.</p>

<p>El seu valor pot ser CLIENT o SERVER, i indica on s'executaran les validacions.<br/>
En el cas que estiguessin configurades les validacions del commons-validator, agafarà el mode de  l'atribut validationType.</p>

<p>Si l'atribut mode i el validationType no fossin iguals saltarà una excepció avisant del conflicte.</p>
<ul>
	<li><b>errorPanelStyleId</b></li>
</ul>


<p>Identificador del panell incrustat. Si no s'identifica fa servir el per defecte.</p>

<h4><a name="TagsdePresentaci%C3%B3-TextiFieldValidator"></a>Text i FieldValidator</h4>

<p>&#42;fwk:text: &#42;Només es mostren els atributs referents a validacions.</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id d'enllaç amb la configuració XML. </td>
</tr>
<tr>
<td class='confluenceTd'> validations </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> validacions pel camp, </td>
</tr>
<tr>
<td class='confluenceTd'> validationFieldMessageMode </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> ICON,TOOLTIP,CHANGESTYLE,TEXTERROR, </td>
</tr>
<tr>
<td class='confluenceTd'> sourceErrorTooltip </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser ICON, TEXT </td>
</tr>
<tr>
<td class='confluenceTd'> iconStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador de l' icona </td>
</tr>
<tr>
<td class='confluenceTd'> textErrorStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div amb el text d'error. </td>
</tr>
<tr>
<td class='confluenceTd'> errorClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Estil de la classe quan està en error. </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació </td>
</tr>
<tr>
<td class='confluenceTd'> dependentFields </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camps dependents </td>
</tr>
<tr>
<td class='confluenceTd'> errorKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del camp internacionalitzat. </td>
</tr>
<tr>
<td class='confluenceTd'> Indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div a mostrar quan es fa petició AJAX. </td>
</tr>
</tbody></table>
<p>f*wk:fieldValidator*: permet que a qualsevol camp de text  se li puguin associar validacions</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Usar el valor  'configurationTag' </td>
</tr>
<tr>
<td class='confluenceTd'> Source </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Component a associar les validacions. </td>
</tr>
<tr>
<td class='confluenceTd'> validations </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> validacions pel camp, </td>
</tr>
<tr>
<td class='confluenceTd'> validationFieldMessageMode </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> ICON,TOOLTIP,CHANGESTYLE,TEXTERROR, </td>
</tr>
<tr>
<td class='confluenceTd'> sourceErrorTooltip </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Pot ser ICON, TEXT </td>
</tr>
<tr>
<td class='confluenceTd'> iconStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Identificador de l' icona </td>
</tr>
<tr>
<td class='confluenceTd'> textErrorStyleId </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div amb el text d'error. </td>
</tr>
<tr>
<td class='confluenceTd'> errorClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Estil de la classe quan està en error. </td>
</tr>
<tr>
<td class='confluenceTd'> validationMessageFunction </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Funció de presentació </td>
</tr>
<tr>
<td class='confluenceTd'> dependentFields </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Camps dependents </td>
</tr>
<tr>
<td class='confluenceTd'> errorKey </td>
<td class='confluenceTd'> Si </td>
<td class='confluenceTd'> Nom del camp internacionalitzat. </td>
</tr>
<tr>
<td class='confluenceTd'> indicator </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Div a mostrar quan es fa petició AJAX. </td>
</tr>
</tbody></table>
<ul>
	<li><b>validations</b></li>
</ul>


<p>Cadena que indica les validacions d'un camp. La cadena permesa és:<br/>
ONCHANGE(r1,r2,...), ONSUBMIT(r3,r4,..)<br/>
Les regles de validació r1 i r2 s'executaran amb l'event onChange, i les regles r3 i r4 s'executaran en l'onSubmit del formulari.</p>

<p>r1,r2,r3,r4 han d'estar definides en el validation-rules.xml.</p>
<ul>
	<li><b>validationFieldMessageMode</b></li>
</ul>


<p>Els valors permesos és un combinació separada per comes dels següents valors.</p>

<p>TOOLTIP: És mostra un tooltip amb el missatge d'error en el camp o en l' icona.<br/>
ICON: Icona d'avís que el camp té un error. Cal informar iconStyleId.<br/>
TEXTERROR: Mostra el missatge en un div. Cal informar textErrorStyleId.<br/>
CHANGESTYLE: Canvi l'aspecte del component. Cal informar errorClass.</p>

<p>Per exemple, si fos TOOLTIP, ICON, mostra un tooltip i una icona.</p>
<ul>
	<li><b>sourceErrorTooltip</b></li>
</ul>


<p>Indica on és vol mostrar el tooltip. Els valors possibles són dos:<br/>
ICON: Mostrar tooltip en l' icona<br/>
TEXT: Mostrar tooltip en el camp.</p>
<ul>
	<li><b>iconStyleId</b></li>
</ul>


<p>Identificador del div que conté l' icona. El tag iconError és un tag fet a mida per mostrar icones.</p>
<ul>
	<li><b>textErrorStyleId</b></li>
</ul>


<p>Identificador del div que mostra el missatge d'error incrustat. El tag textError ajuda en aquesta tasca.</p>
<ul>
	<li><b>errorClass</b></li>
</ul>


<p>Nom de classe CSS que s'aplica en cas d'error en el camp. Normalment posa el marc en vermell del camp i canvia el color de fons.</p>
<ul>
	<li><b>validationMessageFunction</b></li>
</ul>


<p>Funció javascript que permet la presentació del missatge d'error a mida.</p>
<ul>
	<li><b>dependentFields</b></li>
</ul>


<p>Llista de camps dependents. Per exemple pot ser</p>

<p><em>&lt;fwk:text property="age" dependentFields="currentDate,birdhDate" /&gt;</em></p>

<p>Els camps són les properties dels camps de text.</p>
<ul>
	<li><b>errorKey</b></li>
</ul>


<p>Argument que es s'envia per construir el missatge d'error.<br/>
Generalment els missatges d'error es construeixen amb una variable<br/>
Per exemple:<br/>
El camp {0} es obligatori.</p>

<p>Suposem  errorKey = ' ciutat'<br/>
Llavors el missatge d'error serà El camp ciutat es obligatori.</p>

<p>Si hi ha les validacions activades aquest camp es obligatori.</p>
<ul>
	<li><b>indicator</b></li>
</ul>


<p>Identificador del div que es mostra quan hi ha petició a servidor.</p>

<h4><a name="TagsdePresentaci%C3%B3-IconErroriTextError"></a>IconError i TextError</h4>

<p>Aquests dos tags són d'ajuda per tal de facilitar la mostra d'errors del sistema de validació.<br/>
Mostren molt clarament la funcionalitat dels divs. Són molt aconsellables ja que ajuden es veu clarament la funcionalitat de cada tag.</p>

<p>L'IconError s'encarrega d'encapsular la imatge d'avís d'error.</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del div </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CSS del div </td>
</tr>
<tr>
<td class='confluenceTd'> style </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Style del div </td>
</tr>
<tr>
<td class='confluenceTd'> services </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet injectar serveis del contenidor d' spring. </td>
</tr>
</tbody></table>
<p>Exemple</p>

<p>El TextError és un div que permet afegir-hi el missatge d'error.</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Id del div </td>
</tr>
<tr>
<td class='confluenceTd'> styleClass </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> CSS del div </td>
</tr>
<tr>
<td class='confluenceTd'> style </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Style del div </td>
</tr>
<tr>
<td class='confluenceTd'> services </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Permet injectar serveis del contenidor d' spring. </td>
</tr>
</tbody></table>
<p>Exemples:</p>

<p>&#42;? &#42;ICON &amp; TEXTERROR</p>

<p>&lt;td&gt;&lt;fwk:text styleId="lastname" styleClass="fieldtext"<br/>
property="lastname" validationFieldMessageMode="ICON,TEXTERROR"<br/>
validations="ONCHANGE(required),ONSUBMIT(required)"<br/>
sourceErrorTooltip="TEXT" dependentFields="firstname"<br/>
errorClass="errorNew" errorKey="forms.accountForm.field.lastname"<br/>
iconStyleId="lastnameIconError"<br/>
textErrorStyleId="lastnameTextError" /&gt;&lt;/td&gt;<br/>
&lt;td&gt;&lt;fwk:iconError styleId="lastnameIconError"<br/>
style="display:none" styleClass="iconError"&gt;<br/>
&lt;img src="&lt;c:url value="/images/iconWarning.gif"/&gt;"<br/>
id="imagen" class="icon" /&gt;<br/>
&lt;/fwk:iconError&gt;&lt;/td&gt;<br/>
&lt;td&gt;&lt;fwk:textError styleId="lastnameTextError"<br/>
styleClass="errorText" /&gt;&lt;/td&gt;</p>

<p>&#42;? &#42;ICON, TOOLTIP &amp; CHANGESTYLE</p>

<p>&lt;td&gt;&lt;fwk:text styleId="state" property="state"<br/>
styleClass="fieldtext"<br/>
validationFieldMessageMode="ICON,TOOLTIP,CHANGESTYLE"<br/>
validations="ONCHANGE(required),ONSUBMIT(required)"<br/>
sourceErrorTooltip="TEXT" dependentFields="firstname"<br/>
errorClass="errorNew" errorKey="forms.accountForm.field.state"<br/>
iconStyleId="stateIconError" textErrorStyleId="stateTextError" /&gt;<br/>
&lt;/td&gt;<br/>
&lt;td&gt;&lt;fwk:iconError styleId="stateIconError" style="display:none"<br/>
styleClass="iconError"&gt;<br/>
&lt;img src="&lt;c:url value="/images/iconWarning.gif"/&gt;"<br/>
id="imagen" class="icon" /&gt;<br/>
&lt;/fwk:iconError&gt;&lt;/td&gt;<br/>
&lt;td&gt;&lt;fwk:textError styleId="stateTextError" styleClass="errorText" /&gt;<br/>
&lt;/td&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-Validacionsenllistatseditables"></a>Validacions en llistats editables</h3>

<p>Les validacions en llistats editables és el suport a propietats indexades. És a dir poder validar camps amb els noms de propietats a[1].id o a.b[2].name,etc. Els [] denoten propietats indexades i són pròpies de llistats editables.</p>

<p>Seguidament és mostra un exemple de validació en propietats indexades.</p>

<p>&lt;fwk:text styleId="city" property="accounts[0].city" size="20"					   validationFieldMessageMode="ICON,TOOLTIP,CHANGESTYLE" validations="ONCHANGE(required),ONSUBMIT(required)" sourceErrorTooltip="TEXT" iconStyleId="iconErrorCity${count}" errorKey="forms.accountForm.field.city" errorClass="errorNew"/&gt;</p>

<p>Seguidament s'explicarà les peculiaritats segons el mètode de validació.</p>

<p>&#42;-onChange: *</p>

<p>Per aquest sistema no hi ha absolutament cap problema ja que el camp és un etiqueta per aquest sistema de validació i li és igual com s'escrigui.</p>

<p><b>&#45;onSubmit per commons validator:</b></p>

<p><ins>No s'aconsella pel motius seguidament explicats</ins>.</p>

<p>Les propietats indexades s'han d'especificar amb l'atribut indexedListProperty i s'ha d'especificar el nom de la propietat que és una llista.</p>

<p>&lt;form name="accountList"&gt;<br/>
&lt;field property="firstname" indexedListProperty="accounts" depends="required"&gt;<br/>
&lt;arg0 key="forms.accountForm.field.firstname"/&gt;<br/>
&lt;/field&gt;<br/>
&lt;field property="lastname" indexedListProperty="accounts" depends="required"&gt;<br/>
&lt;arg0 key="forms.accountForm.field.firstname"/&gt;<br/>
&lt;/field&gt;</p>

<p>&lt;/form&gt;</p>

<p>El problema d'aquest sistema és que el sistema de presentació d'errors rep el camp erroni però no s'indica la fila errònia i per tant no es pot saber quin camp està malament.</p>

<p>Per exemple en el cas anterior, es rebria com error accounts[].city.</p>

<p><b>&#45;onSubmit per tags</b>.</p>

<p>Si es defineix l'event onSubmit en els tags el problema sorgeix en el mecanisme d'afegir files noves.</p>

<p>Aquest mecanisme dispara un única petició a servidor en busca de la plantilla nova d' afegir. Un cop la té el navegador reemplaça el nomCollecció[0], pel número nomColecció[ultimIndex].<br/>
Aquest últim pas es va repetint tants cops com addRows es facin.</p>

<p>El problema d'aquest mecanisme es que les validacions de submit s'associen a un identificador intern de formulari i es queden a sessió, i per tant per les noves files no hi ha associades validacions de submit.<br/>
Llavors s'ha de fer dos passes.</p>
<ol>
	<li>
	<ol>
		<li>La primera es indicar-li al servidor que tenim una propietat indexada i que totes les validacions de submit de la posició X, generalment la 0, es propaguin a totes les files de la col?lecció.</li>
	</ol>
	</li>
</ol>


<p>Això és fa amb el tag validateCollection.</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Atributs</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Descripció</b> </td>
</tr>
<tr>
<td class='confluenceTd'> property </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Nom de la propietat que és col?lecció </td>
</tr>
<tr>
<td class='confluenceTd'> indexReference </td>
<td class='confluenceTd'> No </td>
<td class='confluenceTd'> Numero de fila referència per a propagar les validacions de submit. Si no s'informa s'assumeix 0. </td>
</tr>
</tbody></table>
<p>Exemple:</p>

<p>&lt;fwk:validateCollection property="accounts" indexReference="0"/&gt;</p>
<ol>
	<li>
	<ol>
		<li>Si en la plantilla de files noves (addRow.jsp) és tenen tags del fwk, segurament caldrà un formulari. En el cas de definir validacions de submit en aquesta plantilla, s'haurà d'informar en el formulari  l'atribut generateId.</li>
	</ol>
	</li>
</ol>


<p>&lt;fwk:form styleId="actionForm11"<br/>
action="accountList.do" 	reqCode="save"<br/>
generateId="&lt;%=request.getParameter("formIdent")%&gt;" 		services="logService:loggingService" &gt;</p>

<h2><a name="TagsdePresentaci%C3%B3-Utilitzaci%C3%B3delServei"></a>Utilització del Servei</h2>


<h3><a name="TagsdePresentaci%C3%B3-%C3%9Asdelstagsalesp%C3%A0ginesJSP"></a>Ús dels tags a les pàgines JSP</h3>

<p>L'ús de cadascun dels tags implica 2 passos:</p>
<ol>
	<li>Definició de la referència a la llibreria de tags</li>
</ol>


<p>Des de la versió JSP 1.2 no és necessari configurar al fitxer web.xml la llibreria i 	podem fer referències directes mitjançant url al jar, tal i com es mostra a 	continuació:</p>

<p>&lt;%@ taglib prefix="fwk" 	uri="http://www.opentrends.net/openframe/open-layout" %&gt;</p>
<ol>
	<li>Definició del tag a la pàgina JSP</li>
</ol>


<p>Una vegada definida la referència a la llibreria i el seu prefix 'fwk' podem incorporar 	qualsevol tag mitjançant '&lt;fwk:nomTag&gt;'.</p>

<p>Per tots els tags d'entrada de dades de formulari es definiran els atributs:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Propietat</b> </td>
<td class='confluenceTd'> <b>Requerit</b> </td>
<td class='confluenceTd'> <b>Valor</b> </td>
</tr>
<tr>
<td class='confluenceTd'> styleId </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Identificador del camp. Aquest identificador és el que correspon a la propietat 'styleId' en el fitxer de configuració del tag </td>
</tr>
<tr>
<td class='confluenceTd'> property </td>
<td class='confluenceTd'> Sí </td>
<td class='confluenceTd'> Nom del atribut del bean associat al formulari que volem mostrar. (l'associació del bean es fa mitjançant la propietat 'pojoClass' del fitxer de configuració de l'acció) </td>
</tr>
</tbody></table>
<p>Exemple:</p>

<p>&lt;fwk:text styleId="firstname" property="firstname"/&gt;</p>

<p>En la següent taula es dona un resum dels tags permesos i la correspondència amb 	la seva classe que s'ha de definir en el fitxer de configuració:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Tag</b> </td>
<td class='confluenceTd'> <b>Classe</b> </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.ActionImageTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.CheckboxFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.configuration.ConfigurationTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.FileFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.FormTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.OptionsFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.PasswordFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.RadioFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.SelectFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.SubmitTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.TextFieldTag </td>
</tr>
<tr>
<td class='confluenceTd'> [] </td>
<td class='confluenceTd'> net.opentrends.openframe.services.web.struts.taglib.forms.fields.TextAreaFieldTag </td>
</tr>
</tbody></table>

<h3><a name="TagsdePresentaci%C3%B3-ComentarisEspec%C3%ADficsaalgunsTags"></a>Comentaris Específics a alguns Tags</h3>

<p>En l'ús del tag 'select' es recomana l'ús de JSTL per a la generació de les opcions incloses.</p>

<p>Exemple:</p>

<p>&lt;fkw:select styleId="..." property="..."&gt;<br/>
&lt;c:forEach items="${nombreLista}" var="item"&gt;<br/>
&lt;fwk:option value="${item}"&gt;${item.descripcion}&lt;/fwk:option&gt;<br/>
&lt;/c:forEach&gt;<br/>
&lt;/select&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-Especificaci%C3%B3delModedelFormulari"></a>Especificació del Mode del Formulari</h3>

<p>En la configuració dels components d'entrada de formulari s'ha explicat com podem mostrar-los de forma diferents segons el mode del formulari. Aquest mode de formulari pot canviar-se mitjançant la crida:</p>

<p>FormUtils.setFormDisplayMode(request, actionForm,mode);</p>

<p>On mode pot ser un dels següents valors:</p>

<p>&#45; FormUtils.INSPECT_MODE. Mode de consulta<br/>
&#45; FormUtils.EDIT_MODE. Mode d'edició<br/>
&#45; FormUtils.CREATE_MODE. Mode de creació</p>

<p><b>? NOTA:</b><br/>
openFrame, dins la seva classe 'ActionExtendedSupport' (classe pare de les nostres action) efectua aquesta tasca per a que no ens haguem de preocupar. Per a això utilitza un <em>resolver</em> que segons el reqCode que arribi per paràmetre decidirà el model del formulari. A continuació es mostra una taula amb els modes usats segons el reqCode:</p>

<p>public static final String EDIT_METHOD_PREFIX = "edit";<br/>
public static final String SEARCH_METHOD_PREFIX = "search";<br/>
public static final String NEW_METHOD_PREFIX = "create";<br/>
public static final String DELETE_METHOD_PREFIX = "delete";<br/>
public static final String SAVE_METHOD_PREFIX = "save";<br/>
public static final String VIEW_METHOD_PREFIX = "view";</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>reqCode</b> </td>
<td class='confluenceTd'> <b>Mode utilitzat</b> </td>
</tr>
<tr>
<td class='confluenceTd'> <b>edit</b> </td>
<td class='confluenceTd'> FormUtils.EDIT_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> search </td>
<td class='confluenceTd'> FormUtils.INSPECT_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> create </td>
<td class='confluenceTd'> FormUtils.CREATE_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> view </td>
<td class='confluenceTd'> FormUtils.INSPECT_MODE </td>
</tr>
<tr>
<td class='confluenceTd'> En altres casos </td>
<td class='confluenceTd'> FormUtils.EDIT_MODE </td>
</tr>
</tbody></table>

<h2><a name="TagsdePresentaci%C3%B3-EinesdeSuport"></a>Eines de Suport</h2>


<h3><a name="TagsdePresentaci%C3%B3-DebugdelesP%C3%A0gines"></a>Debug de les Pàgines</h3>

<p>En l'ús de les nostres pàgines és convenient sempre conèixer si estan ben construïdes. Tal i com es comenta al document 'Entorn de Desenvolupament' mitjançant l'extensió 'Web Developer' i 'Javascript Debugger' podem esbrinar i detectar problemàtiques de les nostres pàgines.</p>

<h2><a name="TagsdePresentaci%C3%B3-Integraci%C3%B3ambAltresServeis"></a>Integració amb Altres Serveis</h2>


<h2><a name="TagsdePresentaci%C3%B3-PreguntesFreq%C3%BCents"></a>Preguntes Freqüents</h2>


<h1><a name="TagsdePresentaci%C3%B3-Exemples"></a>Exemples</h1>


<h1><a name="TagsdePresentaci%C3%B3-Annexos"></a>Annexos</h1>


<h2><a name="TagsdePresentaci%C3%B3-JSTL"></a>JSTL</h2>

<p>Des de fa un temps existeix <b>JSTL</b> (JSP Standard Tag Library). Aquesta llibreria de tags defineix algunes de les tasques bàsiques que necessitem a les nostres pàgines JSP (condicionals, presentació de valors, internacionalització, ...). Si bé no ofereix totes les necessitats que requerim d'una aplicació Web sí ofereix la base del que prèviament es feia amb codi Java o els tags de Struts.</p>

<p>Es recomana l'ús dels tags JSTL de 'core' i 'fmt' que es poden referenciar dins les nostres pàgines com:</p>

<p>&lt;%@ taglib prefix="c"   uri="http://java.sun.com/jstl/core" %&gt;<br/>
&lt;%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt" %&gt;</p>

<p>Podeu veure un resum de JSTL a la url 'http://www.1x4x9.info/files/jstl/html/online-chunked'.</p>

<h2><a name="TagsdePresentaci%C3%B3-AltresTags"></a>Altres Tags</h2>

<p>Tot i l'oferta de tags de openFrame, existeixen altres necessitats, com per exemple l'ús de pestanyes.</p>

<p>En aquest apartat s'ofereixen una llista de components disponibles a la comunitat que poden resoldre aquestes necessitats:</p>
<ol>
	<li>Tags de Crumbs</li>
</ol>


<p>Per a mostrar el típic tag d'enllaços a on ens trobem dins la pàgina podem usar el 	tag de Crumbs de 'Struts Layout'.</p>

<p>Consultar '<a href="http://struts.application-servers.com/doc/tags/crumbs.html" title="Visit page outside Confluence">http://struts.application-servers.com/doc/tags/crumbs.html</a>' per 	conèixer la seva utilització.</p>
<ol>
	<li>Tags de Pestanyes</li>
</ol>


<p>Per a utilitzar pestanyes es recomana la utilització del tag de 'Ditchnet'&#94; ^</p>

<h2><a name="TagsdePresentaci%C3%B3-Aspectesd%27Usabilitat"></a>Aspectes d'Usabilitat</h2>

<p>Aquesta secció pretén donar una visió general del quins aspectes s'han tingut en consideració en els components openFrame per a complir amb normes bàsiques d'usabilitat i accessibilitat.</p>

<p>Algunes de les guies proporcionades poden resultar òbvies però considerem la necessitat de fer-les esmentar per a tenir en consideració. En qualsevol cas, moltes de les guies explicades es troben implementades per openFrame en els seus tags, pel que no s'hauran de tenir en consideració per al desenvolupament de les aplicacions Web. Si més no, també és el nostre propósit mostrar per què s'han pres determinades decisions basades en les guies aquí establertes.</p>

<p>A continuació es detallen les guies utilitzades:</p>
<ol>
	<li>La descripció del component d'entrada hauria de precedir al component (excepte els radio i els checkbox)</li>
	<li>Usar l'etiqueta 'label' i l'atribut 'for' per a fer referència al component que descriu.<br/>
(1) i (2) són realitzats pels tags openFrame.</li>
</ol>


<ol>
	<li>Els camps de tipus text haurien de ser seleccionats quan reben el focus</li>
</ol>


<p>openFrame permet especificar la propietat 'selectOnFocus' per a lligar aquest 	comportament als nostres components. Per defecte es troba a 'true'.</p>
<ol>
	<li>Els camps haurien de definir la seva longitud màxima mitjançant les propietats 'maxLength', 'width', 'size' i 'cols'</li>
</ol>


<p>Aquestes propietats han de ser definides pels desenvolupadors.</p>
<ol>
	<li>En els camps requerits haurem d'utilitzar alguna representació per indicar que són obligatoris. Si es fa servir una icona o símbol <img class="emoticon" src="./icons/emoticons/star_yellow.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> indicar a la pàgina què significa</li>
</ol>


<p>openFrame mostra, per defecte, un asterisc a l'esquerra de l'etiqueta del component 	si el seu atribut associat ha estat definit com a obligatori dins el Servei de Validació.</p>
<ol>
	<li>Quan anem a entrar dades a un component hauríem de mostrar alguna decoració que indiqui que estem en aquell component</li>
</ol>


<p>Per exemple podem usar el següent estil (basat en 'theserverside.com'):</p>

<p>form input, form textarea, form select {<br/>
padding-left: 4px;<br/>
color: #666;<br/>
}</p>

<p>O bé:</p>

<p>input.input-text, textarea { border: 1px solid #859085; background: transparent; padding: 1px 3px; }<br/>
input.hover, textarea.hover { border-color: #000; background-color: #ffe; }<br/>
input.active, textarea.active { border-color: #f00; background-color: #fff; }<br/>
input.input-button, button, select { border-width: 1px; padding: 0px; }<br/>
input.input-text, input.input-button, button, select, textarea { font: 90% tahoma,verdana,sans-serif; }<br/>
input.input-disabled { background-color: #ccc; border-color: #999; color: #777; }</p>

<h2><a name="TagsdePresentaci%C3%B3-CSS%28CascadeStyleSheets%29"></a>CSS (Cascade Style Sheets)</h2>

<p>Tot i que no és propòsit de openFrame oferir un tutorial en detall de què són els CSS i com fer-los servir es considera bàsic el seu coneixement.</p>

<p>A continuació s'ofereix un resum de quins aspectes es consideren important a tenir en compte:</p>

<h3><a name="TagsdePresentaci%C3%B3-Importaci%C3%B3defitxersd%27estils"></a>Importació de fitxers d'estils</h3>

<p>Podem agrupar l'ús de varis fitxers d'estils mitjançant la sentència '@import'.</p>

<p>&lt;style type="text/css" media="all"&gt;<br/>
@import "file1.css";<br/>
@import "file2.css";<br/>
&lt;/style&gt;</p>

<h3><a name="TagsdePresentaci%C3%B3-4.4.2.Utilitzaci%C3%B3deidsiclasses"></a>4.4.2. Utilització de ids i classes</h3>

<p>Mitjançant l'ús d'identificadors de classe (incorporant '.' al davant del nom de la classe) podem definir quin serà l'estil a aplicar a tots els tags que incorporin aquest nom de class (en els tags openFrame correspon a la propietat 'styleClass').</p>

<p><b>.required</b> {font-family: Verdana; font-size: 12pt; color: red; }</p>

<p>Aquest estil s'aplicarà a tots els components que tinguin com a class='required', siguin divs, spans, ...</p>

<p>En cas que volem aplicar un estil a un únic component farem servir identificadors. És a dir, partint del id assignat al component (en openFrame l'atribut 'styleId' dels components), podem assignar un estil usant '#':</p>

<p><b>&#35;header</b> {width: 90%; background: white; font-size: 20px; color: purple; }</p>

<p>&lt;div <b>id</b>="header"&gt;...&lt;/div&gt;</p>

<p>Sempre podem definir els estils al mateix component (atribut 'style') o sobreescriure els definits al fitxer d'estil:</p>

<p>&lt;span class="caution" style="color: green"&gt;text&lt;/span&gt;</p>

<p>Si volem definir el mateix estil a diferents ids o classes podem separar cadascun d'ells amb espai tal i com es mostra en el següent exemple:</p>

<p><b>p b</b> {color: red; }</p>

<p>Inclús podem definir que tots els components inclosos a un id o class determinat actuïn de forma determinada:</p>

<p><b>div#navigation a</b> {color: white; }</p>

<p>En aquest cas, s'aplicarà l'estil a tots els '&lt;a href...' que estiguin inclosos a un div amb id='navigation'</p>

<h3><a name="TagsdePresentaci%C3%B3-EfectesComuns"></a>Efectes Comuns</h3>

<p>En la següent taula es mostra un resum d'algunes de les propietats més útils a definir:</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>Efecte</b> </td>
<td class='confluenceTd'> <b>Configuració</b> </td>
</tr>
<tr>
<td class='confluenceTd'> <b>Text en itàlica</b> </td>
<td class='confluenceTd'> font-style: italic; (tornar a normal amb font-style:normal) </td>
</tr>
<tr>
<td class='confluenceTd'> Text en negreta </td>
<td class='confluenceTd'> font-weight: bold;  (tornar a normal amb font-weight:normal) </td>
</tr>
<tr>
<td class='confluenceTd'> Text en normal </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Capitalització </td>
<td class='confluenceTd'><ol>
	<li>Tot a majúscules: text-transform: uppercase;</li>
	<li>Tot a minúscules: text-transform: lowercase;</li>
	<li>Primera lletra a majúscules: text-transform: capitalize;</li>
	<li>Normal:text-transform: normal;</li>
</ol>
</td>
</tr>
<tr>
<td class='confluenceTd'> Enllaç sense decoració </td>
<td class='confluenceTd'> <b>a</b> {text-decoration: none; } </td>
</tr>
<tr>
<td class='confluenceTd'> <b>Marges</b> </td>
<td class='confluenceTd'> margin: 20px; <br clear="all" />
margin-left: 2px; margin-top: 80px; margin-right: 45px; margin-bottom: &#45;5px; </td>
</tr>
</tbody></table>
<p><b>IMPORTANT</b>:</p>

<p>Des de que va sortir HTML el body incorpora un espai addicional que podem eliminar amb:</p>

<p><b>body</b> {margin: 0px; padding: 0px; }</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> Padding </td>
<td class='confluenceTd'> S'aplica entre els elements <br clear="all" />
padding: 6px; padding-bottom: 2px; padding-left: 18px; </td>
</tr>
<tr>
<td class='confluenceTd'> Color de Background als elements </td>
<td class='confluenceTd'> background-color: green; <br clear="all" />
background-color: rgb(0,108,64); </td>
</tr>
<tr>
<td class='confluenceTd'> Imatge de background als elements </td>
<td class='confluenceTd'> background-image: url(images/required.gif); </td>
</tr>
</tbody></table>

<h3><a name="TagsdePresentaci%C3%B3-PseudoClasses"></a>Pseudo Classes</h3>

<p>Tot i que podem definir selectors o estils a la majoria d'elements, hi ha parts que no són elements en sí sinó parts d'aquests. Mitjançant pseudo classes podem accedir a aquests elements.</p>

<p>Com a guia de openFrame es proporciona al fitxer d'estils una pseudo classe per presentar els components d'entrada de diferent forma quan ubiquem el focus.</p>

<p>form input, form textarea, form select {<br/>
padding-left: 4px;<br/>
color: #666;<br/>
}</p>

<p><b>/&#42; Warning: IE doesn't support pseudo-class :focus &#42;/</b><br/>
<b>form input:focus, form textarea:focus, form select:focus {</b></p>
<ul>
	<li>border-bottom: #ffdead solid 2px;&#42;</li>
	<li>border-right: #ffdead solid 2px;&#42;</li>
	<li>border-left: #c07300 solid 2px;&#42;</li>
	<li>border-top:  #c07300 solid 2px;&#42;</li>
	<li>color: #000;&#42;<br/>
&#42;<b>}</b>&#42;</li>
</ul>


<p>NOTA: Internet Explorer no suporta pseudo classes</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image002.gif">image002.gif</a> (image/gif; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image001.jpg">image001.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image004.gif">image004.gif</a> (image/gif; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image003.jpg">image003.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image006.gif">image006.gif</a> (image/gif; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image005.gif">image005.gif</a> (image/gif; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image008.jpg">image008.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image007.jpg">image007.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image009.jpg">image009.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image010.jpg">image010.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image011.jpg">image011.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image013.jpg">image013.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image012.jpg">image012.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image015.jpg">image015.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                            <img src="icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="Tags de Presentació_attachments/image014.jpg">image014.jpg</a> (image/jpeg; charset=ISO-8859-1)
                                <br/>
                                                    </div>
				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Apr 14, 2015 11:50</font></td>
		    </tr>
	    </table>
    </body>
</html>